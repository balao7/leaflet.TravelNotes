/*! leaflet.Travel - version 0.1.0 - 2017-10-04 - Copyright 2015 2017 Christian Guyette - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/


!function t(e,o,a){function n(i,s){if(!o[i]){if(!e[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(r)return r(i,!0);var d=new Error("Cannot find module '"+i+"'");throw d.code="MODULE_NOT_FOUND",d}var u=o[i]={exports:{}};e[i][0].call(u.exports,function(t){var o=e[i][1][t];return n(o||t)},u,u.exports,t,e,o,a)}return o[i].exports}for(var r="function"==typeof require&&require,i=0;i<a.length;i++)n(a[i]);return n}({1:[function(t,e,o){(function(o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{init:function(e){o.config={contextMenu:{timeout:1500},routing:{auto:!0},language:"fr",itineraryPointMarker:{color:"red",weight:2,radius:7,fill:!1},wayPoint:{reverseGeocoding:!1},route:{color:"#ff0000",width:3},note:{reverseGeocoding:!1,grip:{size:10,opacity:0},polyline:{color:"gray",weight:1},style:"TravelNotes-NotesStyle"},itineraryPointZoom:17,routeEditor:{displayEditionInHTMLPage:!0},travelEditor:{clearAfterSave:!0}},o.version="1.0.0",o.map=e,o.travelObjId=0,o.editedRoute=t("../data/Route")(),o.editedRoute.routeChanged=!1,o.editedRoute.routeInitialObjId=-1,o.travel=t("../data/Travel")(),o.mapObjects=new Map,o.routing={},o.UUID=t("../util/Utilities")().UUID},get UUID(){return o.UUID},get version(){return o.version},get routing(){return o.routing},set routing(t){o.routing=t},get providers(){return o.providers},get editedRoute(){return o.editedRoute},set editedRoute(t){o.editedRoute=t},get travel(){return o.travel},set travel(t){o.travel=t},get config(){return o.config},set config(t){o.config=t},get mapObjects(){return o.mapObjects},get map(){return o.map},getNoteAndRoute:function(t){var e=null;if(e=this.travel.notes.getAt(t))return{note:e,route:null};for(var o=this.travel.routes.iterator;!o.done;)if(e=o.value.notes.getAt(t))return{note:e,route:o.value};return(e=this.editedRoute.notes.getAt(t))?{note:e,route:this.editedRoute}:(console.log("Invalid noteObjId "+t+" for function DataManager.getNote ( )"),{note:null,route:null})},getRoute:function(t){var e=null;return(e=this.travel.routes.getAt(t))||t===this.editedRoute.objId&&(e=this.editedRoute),e||console.log("Invalid noteObjId "+t+" for function DataManager.getRoute ( )"),e}}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../data/Route":38,"../data/Travel":39,"../util/Utilities":42}],2:[function(t,e,o){!function(){"use strict";var o=t("../data/ObjType")("Itinerary",t("../data/DataManager")().version);void 0!==e&&e.exports&&(e.exports=function(){var e="",a="",n=t("../data/Collection")("ItineraryPoint"),r=t("../data/Collection")("Maneuver"),i=t("../data/ObjId")();return{get itineraryPoints(){return n},get maneuvers(){return r},get provider(){return e},set provider(t){e=t},get transitMode(){return a},set transitMode(t){a=t},get objId(){return i},get objType(){return o},get object(){return{itineraryPoints:n.object,maneuvers:r.object,provider:e,transitMode:a,objId:i,objType:o.object}},set object(s){s=o.validate(s),n.object=s.itineraryPoints||[],r.object=s.maneuvers||[],e=s.provider||"",a=s.transitMode||"",i=t("../data/ObjId")();for(var l=new Map,d=0,u=n.iterator;!u.done;)l.set(s.itineraryPoints[d].objId,u.value.objId),d++;for(var c=r.iterator;!c.done;)c.value.itineraryPointObjId=l.get(c.value.itineraryPointObjId)}}})}()},{"../data/Collection":30,"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37}],3:[function(t,e,o){!function(){"use strict";var o=t("../data/ObjType")("Route",t("../data/DataManager")().version);void 0!==e&&e.exports&&(e.exports=function(){var e="",a=t("../data/Collection")("WayPoint");a.add(t("../data/Waypoint")()),a.add(t("../data/Waypoint")());var n=t("../data/Collection")("Note"),r=t("../data/Itinerary")(),i=t("../data/DataManager")().config.route.width||5,s=t("../data/DataManager")().config.route.color||"#ff0000",l=!1,d=0,u=0,c=0,v=t("../data/ObjId")();return{get wayPoints(){return a},get itinerary(){return r},get notes(){return n},get name(){return e},set name(t){e=t},get width(){return i},set width(t){i=t},get color(){return s},set color(t){s=t},get chain(){return l},set chain(t){l=t},get chainedDistance(){return d},set chainedDistance(t){d=t},get distance(){return u},set distance(t){u=t},get duration(){return c},set duration(t){c=t},get objId(){return v},get objType(){return o},get object(){return{name:e,wayPoints:a.object,notes:n.object,itinerary:r.object,width:i,color:s,chain:l,distance:u,duration:c,chainedDistance:d,objId:v,objType:o.object}},set object(g){g=o.validate(g),e=g.name||"",a.object=g.wayPoints||[],n.object=g.notes||[],r.object=g.itinerary||t("./Itinerary")().object,i=g.width||5,s=g.color||"#000000",l=g.chain||!1,u=g.distance,c=g.duration,d=g.chainedDistance,v=t("../data/ObjId")()}}})}()},{"../data/Collection":30,"../data/DataManager":31,"../data/Itinerary":32,"../data/ObjId":36,"../data/ObjType":37,"../data/Waypoint":41,"./Itinerary":2}],4:[function(t,e,o){!function(){"use strict";var o=t("../data/ObjType")("Travel",t("../data/DataManager")().version);void 0!==e&&e.exports&&(e.exports=function(){var e="TravelNotes",a=t("../data/Collection")("Route");a.add(t("../data/Route")());var n=t("../data/Collection")("Note"),r=t("../data/ObjId")(),i={};return{get routes(){return a},get notes(){return n},get name(){return e},set name(t){e=t},get userData(){return i},set userData(t){i=t},get objId(){return r},get objType(){return o},get object(){return{name:e,routes:a.object,notes:n.object,userData:i,objId:r,objType:o.object}},set object(s){s=o.validate(s),e=s.name||"",i=s.userData||{},a.object=s.routes||[],n.object=s.notes||[],r=t("../data/ObjId")()}}})}()},{"../data/Collection":30,"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37,"../data/Route":38}],5:[function(t,e,o){!function(){"use strict";L.TravelNotes=L.TravelNotes||{},L.travelNotes=L.travelNotes||{},L.TravelNotes.Control=L.Control.extend({options:{position:"topright"},initialize:function(t){L.Util.setOptions(this,t)},onAdd:function(e){return t("./UI/UserInterface")().UI}}),L.travelNotes.control=function(t){return new L.TravelNotes.Control(t)},void 0!==e&&e.exports&&(e.exports=L.travelNotes.control)}()},{"./UI/UserInterface":21}],6:[function(t,e,o){(function(o){!function(){"use strict";L=L||{},L.TravelNotes=L.TravelNotes||{},L.travelNotes=L.travelNotes||{};var a=[],n=[],r=!1,i=!1,s="",l=t("./data/DataManager")(),d=t("./util/Utilities")();L.TravelNotes.Interface=function(){var u=function(){for(var t=decodeURI(window.location.search).substr(1).split("&"),e="?",o=0;o<t.length;o++){var a=t[o].split("=");2===a.length&&-1!==a[0].indexOf("ProviderKey")?d.storageAvailable("sessionStorage")&&sessionStorage.setItem(a[0].substr(0,a[0].length-11).toLowerCase(),btoa(a[1])):(e+="?"===e?"":"&",e+=t[o]),2===a.length&&"lng"===a[0].toLowerCase()&&(s=a[1].toLowerCase())}var n={index:"bar"};history.pushState(n,"page",e),l.providers.forEach(function(t){if(t.providerKeyNeeded){var e=null;d.storageAvailable("sessionStorage")&&(e=sessionStorage.getItem(t.name.toLowerCase())),e||l.providers.delete(t.name.toLowerCase())}})},c=function(e){l.travel.readOnly||t("./UI/ContextMenu")(e,t("./core/RouteEditor")().getMapContextMenu([e.latlng.lat,e.latlng.lng]).concat(t("./core/NoteEditor")().getMapContextMenu([e.latlng.lat,e.latlng.lng])).concat(a))},v=function(e){l.travel.readOnly||t("./UI/ContextMenu")(e,t("./core/RouteEditor")().getMapContextMenu([e.latlng.lat,e.latlng.lng]).concat(t("./core/NoteEditor")().getMapContextMenu([e.latlng.lat,e.latlng.lng])).concat(t("./core/TravelEditor")().getMapContextMenu([e.latlng.lat,e.latlng.lng])).concat(n))};return{addControl:function(o,a,n){l.init(o),u();var r=new XMLHttpRequest;r.onreadystatechange=function(i){if(this.readyState===r.DONE)if(200===this.status)try{l.config=JSON.parse(this.responseText),console.log(l.config),""!==s&&(l.config.language=s),l.travel=t("./data/Travel")();var d=new XMLHttpRequest;d.onreadystatechange=function(r){if(this.readyState===d.DONE){if(200===this.status)try{t("./UI/Translator")().setTranslations(JSON.parse(this.responseText))}catch(t){console.log("Not possible to parse TravelNotes"+l.config.language.toLowerCase()+".json")}else console.log("Not possible to load TravelNotes"+l.config.language.toLowerCase()+".json");a?document.getElementById(a).appendChild(t("./UI/UserInterface")().UI):void 0!==e&&e.exports&&o.addControl(t("./L.TravelNotes.Control")(n)),t("./UI/TravelEditorUI")().setRoutesList(l.travel.routes),t("./core/TravelEditor")().openServerTravel(),t("./core/TravelEditor")().changeTravelHTML()}},d.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotes"+l.config.language.toLowerCase()+".json",!0),d.send(null)}catch(t){console.log("Not possible to parse TravelNotesConfig.json")}else console.log("Not possible to load TravelNotesConfig.json")},r.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesConfig.json",!0),r.send(null)},addProvider:function(t){o.providers||(o.providers=new Map),o.providers.set(t.name.toLowerCase(),t)},addMapContextMenu:function(t,e){t&&l.map.on("click",c),e&&l.map.on("contextmenu",c)},getProviderKey:function(e){var o="";if(t("./util/Utilities")().storageAvailable("sessionStorage")){var a=sessionStorage.getItem(e.toLowerCase());a&&(o=atob(a))}return o},get userData(){return l.travel.userData?l.travel.userData:{}},set userData(t){l.travel.userData=t},get rightContextMenu(){return r},set rightContextMenu(t){t&&!r?(l.map.on("contextmenu",v),r=!0):!t&&r&&(l.map.off("contextmenu",v),r=!1)},get leftContextMenu(){return i},set leftContextMenu(t){t&&!i?(l.map.on("click",c),i=!0):!t&&i&&(l.map.off("click",c),i=!1)},get leftUserContextMenu(){return a},set leftUserContextMenu(t){a=t},get rightUserContextMenu(){return n},set rightUserContextMenu(t){n=t},get maneuver(){return t("./data/Maneuver")()},get itineraryPoint(){return t("./data/ItineraryPoint")()},get version(){return t("./data/DataManager")().version}}},L.travelNotes.interface=function(){return L.TravelNotes.Interface()},void 0!==e&&e.exports&&(e.exports=L.travelNotes.interface)}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./L.TravelNotes.Control":5,"./UI/ContextMenu":10,"./UI/Translator":19,"./UI/TravelEditorUI":20,"./UI/UserInterface":21,"./core/NoteEditor":26,"./core/RouteEditor":27,"./core/TravelEditor":29,"./data/DataManager":31,"./data/ItineraryPoint":33,"./data/Maneuver":34,"./data/Travel":39,"./util/Utilities":42}],7:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(e){var o=t("../UI/BaseDialog")();return o.title=t("../UI/Translator")().getText("AboutDialog - Title"),t("./HTMLElementsFactory")().create("div",{id:"TravelNotes-AboutDialog-AboutDiv"},o.content).innerHTML="<p>This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.</p><p>Copyright - 2017 - Christian Guyette</p><p>Contact : <a href='http://www.ouaie.be/blog/pages/contact' target='_blank'>http://www.ouaie.be/</a></p><p>GitHub : <a href='https://github.com/wwwouaiebe/leaflet.TravelNotes' target='_blank'>https://github.com/wwwouaiebe/leaflet.TravelNotes</a></p><p>Version : "+t("../data/DataManager")().version+".",o.center(),o})}()},{"../UI/BaseDialog":8,"../UI/Translator":19,"../data/DataManager":31,"./HTMLElementsFactory":12}],8:[function(t,e,o){!function(){"use strict";var o=function(t){"Escape"!==t.key&&"Esc"!==t.key||(document.removeEventListener("keydown",o,!0),document.getElementsByTagName("body")[0].removeChild(document.getElementById("TravelNotes-BaseDialog-BackgroundDiv")))};void 0!==e&&e.exports&&(e.exports=function(){var e=null,a=t("./HTMLElementsFactory")(),n=document.getElementsByTagName("body")[0],r=a.create("div",{id:"TravelNotes-BaseDialog-BackgroundDiv",className:"TravelNotes-BaseDialog-BackgroundDiv"},n);r.addEventListener("dragover",function(t){},!1),r.addEventListener("drop",function(t){},!1);var i=r.clientWidth,s=r.clientHeight,l=0,d=0,u=0,c=0,v=a.create("div",{id:"TravelNotes-BaseDialog-Container",className:"TravelNotes-BaseDialog-Container"},r),g=a.create("div",{id:"TravelNotes-BaseDialog-TopBar",className:"TravelNotes-BaseDialog-TopBar",draggable:!0},v);a.create("div",{innerHTML:"&#x274c",id:"TravelNotes-BaseDialog-CancelButton",title:t("../UI/Translator")().getText("DialogBase - close")},g).addEventListener("click",function(){document.removeEventListener("keydown",o,!0),document.getElementsByTagName("body")[0].removeChild(r)},!1),g.addEventListener("dragstart",function(t){try{t.dataTransfer.setData("Text","1")}catch(t){}l=t.screenX,d=t.screenY},!1),g.addEventListener("dragend",function(t){u+=t.screenX-l,c+=t.screenY-d,u=Math.min(Math.max(u,20),i-v.clientWidth-20),c=Math.max(c,20);var e=s-Math.max(c,0)-20;v.setAttribute("style","top:"+c+"px;left:"+u+"px;max-height:"+e+"px;")},!1);var p=a.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv",id:"TravelNotes-BaseDialog-HeaderDiv"},v),T=a.create("div",{className:"TravelNotes-BaseDialog-ContentDiv",id:"TravelNotes-BaseDialog-ContentDiv"},v),m=(a.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-BaseDialog-ErrorDivHidden",id:"TravelNotes-BaseDialog-ErrorDiv"},v),a.create("div",{className:"TravelNotes-BaseDialog-FooterDiv",id:"TravelNotes-BaseDialog-FooterDiv"},v));return a.create("div",{innerHTML:"&#x1f4be;",id:"TravelNotes-BaseDialog-OkButton",className:"TravelNotes-BaseDialog-Button"},m).addEventListener("click",function(){e&&!e()||(document.removeEventListener("keydown",o,!0),document.getElementsByTagName("body")[0].removeChild(r))},!1),document.addEventListener("keydown",o,!0),{addClickOkButtonEventListener:function(t){e=t},get title(){return p.innerHTML},set title(t){p.innerHTML=t},center:function(){u=(i-v.clientWidth)/2,c=(s-v.clientHeight)/2,u=Math.min(Math.max(u,20),i-v.clientWidth-20),c=Math.max(c,20);var t=s-Math.max(c,0)-20;v.setAttribute("style","top:"+c+"px;left:"+u+"px;max-height:"+t+"px;")},get header(){return p},set header(t){p=t},get content(){return T},set content(t){T=t},get footer(){return m},set footer(t){m=t}}})}()},{"../UI/Translator":19,"./HTMLElementsFactory":12}],9:[function(t,e,o){!function(){"use strict";var o=function(){return!0};void 0!==e&&e.exports&&(e.exports=function(e){var a=function(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}},n=function(t,e,o){return"#"+parseInt(t).toString(16).padStart(2,"0")+parseInt(e).toString(16).padStart(2,"0")+parseInt(o).toString(16).padStart(2,"0")},r=function(){i=n(E.value,h.value,y.value),document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+i+";")},i=e,s=t("../UI/Translator")(),l=t("./HTMLElementsFactory")(),d=t("../UI/BaseDialog")();d.title=s.getText("ColorDialog - Title"),d.addClickOkButtonEventListener(o),d.getNewColor=function(){return i};for(var u=l.create("div",{className:"TravelNotes-ColorDialog-ColorDiv",id:"TravelNotes-ColorDialog-ColorDiv"},d.content),c=l.create("div",{className:"TravelNotes-ColorDialog-ButtonsDiv",id:"TravelNotes-ColorDialog-ButtonsDiv"},u),v=255,g=255,p=255,T=0;++T<8;){var m=l.create("div",{className:"TravelNotes-ColorDialog-RowColorDiv",id:"TravelNotes-ColorDialog-RowColorDiv"+T},c),f=0;for(g=255;++f<7;){var N=l.create("div",{className:"TravelNotes-ColorDialog-CellColorDiv",id:"TravelNotes-ColorDialog-CellColorDiv"+T+f},m);if(T<7)N.setAttribute("style","background-color:"+n(v,g,p)),N.colorValue=n(v,g,p),N.addEventListener("click",function(t){i=t.target.colorValue;var e=a(i);E.value=e.r,h.value=e.g,y.value=e.b,document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+t.target.colorValue+";")},!1),g-=51;else{var I=n(255,v=51*(f-1),v);N.setAttribute("style","background-color:"+I),N.redValue=255-v,N.addEventListener("click",function(t){for(var e=t.target.redValue,o=255,a=255,r=0;++r<7;){var i=0;for(o=255;++i<7;){var s=document.getElementById("TravelNotes-ColorDialog-CellColorDiv"+r+i);s.colorValue=n(e,o,a),s.setAttribute("style","background-color:"+n(e,o,a)),o-=51}a-=51}},!1)}}p-=51}var L=l.create("div",{className:"TravelNotes-ColorDialog-DataDiv",id:"TravelNotes-ColorDialog-DataDiv"},u);l.create("text",{data:s.getText("ColorDialog - red")},L);var E=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-RedInput"},L);E.value=a(e).r,E.min=0,E.max=255,E.addEventListener("input",r,!1),l.create("text",{data:s.getText("ColorDialog - green")},L);var h=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-GreenInput"},L);h.value=a(e).g,h.min=0,h.max=255,h.addEventListener("input",r,!1),l.create("text",{data:s.getText("ColorDialog - blue")},L);var y=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-BlueInput"},L);return y.value=a(e).b,y.min=0,y.max=255,y.addEventListener("input",r,!1),l.create("div",{className:"TravelNotes-ColorDialog-ColorSampleDiv",id:"TravelNotes-ColorDialog-ColorSampleDiv"},u).setAttribute("style","background-color:"+e+";"),d.center(),d})}()},{"../UI/BaseDialog":8,"../UI/Translator":19,"./HTMLElementsFactory":12}],10:[function(t,e,o){!function(){"use strict";var o=[],a=null,n=null,r=0,i=0,s=0,l=null,d=function(){l&&(clearTimeout(l),l=null),i=0,s=0,document.removeEventListener("keydown",u,!0),document.removeEventListener("keypress",c,!0),document.removeEventListener("keyup",v,!0);var t=a.childNodes;t[0].firstChild.removeEventListener("click",d,!1);for(var e=1;e<t.length;e++)t[e].firstChild.removeEventListener("click",d,!1);document.getElementsByTagName("body")[0].removeChild(a),a=null,r=0},u=function(t){a&&(t.preventDefault(),t.stopPropagation()),"Escape"!==t.key&&"Esc"!==t.key||d(),"ArrowDown"!==t.key&&"ArrowRight"!==t.key&&"Tab"!==t.key||(r=r>=o.length?1:++r,a.childNodes[r].firstChild.focus()),"ArrowUp"!==t.key&&"ArrowLeft"!==t.key||(r=r<=1?o.length:--r,a.childNodes[r].firstChild.focus()),"Home"===t.key&&(r=1,a.childNodes[r].firstChild.focus()),"End"===t.key&&(r=o.length,a.childNodes[r].firstChild.focus()),"Enter"===t.key&&r>0&&o[r-1].action&&a.childNodes[r].firstChild.click()},c=function(t){t.preventDefault(),t.stopPropagation()},v=function(t){t.preventDefault(),t.stopPropagation()},g=function(t){t.stopPropagation(),o[t.target.menuItem].param?o[t.target.menuItem].action.call(o[t.target.menuItem].context,o[t.target.menuItem].param,n):o[t.target.menuItem].action.call(o[t.target.menuItem].context,n),d()};void 0!==e&&e.exports&&(e.exports=function(e,r){if(e.latlng.lat===i&&e.latlng.lng===s)return i=0,void(s=0);if(i=e.latlng.lat,s=e.latlng.lng,n=e,a)d();else{o=r;var p=document.getElementsByTagName("body")[0],T=t("./HTMLElementsFactory")(),m=T.create("div",{className:"TravelNotes-ContextMenu-Panel"},p),f=m.clientWidth,N=m.clientHeight;p.removeChild(m),(a=T.create("div",{id:"TravelNotes-ContextMenu-Container",className:"TravelNotes-ContextMenu-Container"},p)).addEventListener("mouseenter",function(){l&&(clearTimeout(l),l=null)},!1),a.addEventListener("mouseleave",function(){l=setTimeout(d,t("../data/DataManager")().config.contextMenu.timeout)},!1),T.create("div",{innerHTML:"&#x274c",className:"TravelNotes-ContextMenu-CloseButton",title:t("./Translator")().getText("ContextMenu - close")},a).addEventListener("click",d,!1);var I=0;o.forEach(function(t){var e=T.create("div",{className:"TravelNotes-ContextMenu-ItemContainer"},a),o=T.create("button",{innerHTML:t.name,id:"TravelNotes-ContextMenu-Item"+I,className:t.action?"TravelNotes-ContextMenu-Item":"TravelNotes-ContextMenu-Item TravelNotes-ContextMenu-ItemDisabled"},e);t.action&&o.addEventListener("click",g,!1),o.menuItem=I,++I});var L=Math.min(e.originalEvent.clientY,N-a.clientHeight-20),E=Math.min(e.originalEvent.clientX,f-a.clientWidth-20);a.setAttribute("style","top:"+L+"px;left:"+E+"px;"),document.addEventListener("keydown",u,!0),document.addEventListener("keypress",c,!0),document.addEventListener("keyup",v,!0)}})}()},{"../data/DataManager":31,"./HTMLElementsFactory":12,"./Translator":19}],11:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var e=t("./Translator")(),o=function(o){if(!document.getElementById("TravelNotes-Control-ErrorDataDiv")){var a=t("./HTMLElementsFactory")();a.create("div",{id:"TravelNotes-Control-ErrorDataDiv",className:"TravelNotes-Control-DataDiv TravelNotes-Control-HiddenList"},o);var n=a.create("div",{id:"TravelNotes-Control-ErrorHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},o);a.create("span",{innerHTML:"&#x25b6;",title:e.getText("ErrorEditorUI - Show"),id:"TravelNotes-Control-ErrorExpandButton",className:"TravelNotes-Control-ExpandButton"},n).addEventListener("click",function(t){if(t.stopPropagation(),document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML.length){document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.toggle("TravelNotes-Control-HiddenList");var o=document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-ErrorExpandButton").innerHTML=o?"&#x25b6;":"&#x25b2;",document.getElementById("TravelNotes-Control-ErrorExpandButton").title=o?e.getText("ErrorEditorUI - Show"):e.getText("ErrorEditorUI - Hide"),o&&(document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML="")}},!1),a.create("span",{innerHTML:e.getText("ErrorEditorUI - Errors"),id:"TravelNotes-Control-ErrorHeaderText",className:"TravelNotes-Control-HeaderText"},n)}},a=function(){document.getElementById("TravelNotes-Control-ErrorExpandButton").innerHTML="&#x25b2;",document.getElementById("TravelNotes-Control-ErrorExpandButton").title=e.getText("ErrorEditorUI - Hide"),document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.remove("TravelNotes-Control-HiddenList")},n=function(){document.getElementById("TravelNotes-Control-ErrorExpandButton").innerHTML="&#x25b6;",document.getElementById("TravelNotes-Control-ErrorExpandButton").title=e.getText("ErrorEditorUI - Show"),document.getElementById("TravelNotes-Control-ErrorDataDiv").add("TravelNotes-Control-HiddenList")};return{createUI:function(t){o(t)},expand:function(){a()},reduce:function(){n()},set message(t){document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML=t},get message(){return document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML}}})}()},{"./HTMLElementsFactory":12,"./Translator":19}],12:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{create:function(t,e,o){var a;if(a="text"===t.toLowerCase()?document.createTextNode(""):document.createElement(t),o&&o.appendChild(a),e)for(var n in e)try{a[n]=e[n]}catch(t){console.log("Invalid property : "+n)}return a}}})}()},{}],13:[function(t,e,o){!function(){"use strict";var o=t("../UI/HTMLElementsFactory")(),a=t("../data/DataManager")(),n=t("../UI/Translator")(),r=t("../util/Utilities")(),i=t("../core/NoteEditor")(),s=t("../core/RouteEditor")(),l="TravelNotes-Control-";void 0!==e&&e.exports&&(e.exports=function(){var e=function(t,e){o.create("div",{className:l+"Travel-Notes-IconCell",innerHTML:t.iconContent},e).setAttribute("style","width:"+t.iconWidth+"px;"),o.create("div",{className:l+"Travel-Notes-Cell",innerHTML:i.getNoteHTML(t,l)},e)},d=function(){var t=o.create("div",{className:l+"Travel-Header"});o.create("div",{className:l+"Travel-Header-Name",innerHTML:a.travel.name},t);for(var e=0,i=a.travel.routes.iterator;!i.done;)o.create("div",{className:l+"Travel-Header-RouteName",innerHTML:'<a href="#route'+i.value.objId+'">'+i.value.name+"</a>&nbsp;:&nbsp;"+r.formatDistance(i.value.distance)+"."},t),i.value.chain&&(e+=i.value.distance);return o.create("div",{className:l+"Travel-Header-TravelDistance",innerHTML:n.getText("HTMLViewsFactory - Travel distance",{distance:r.formatDistance(e)})},t),t},u=function(){for(var t=o.create("div",{className:l+"Travel-Notes"}),n=a.travel.notes.iterator;!n.done;){var r=o.create("div",{className:l+"Travel-Notes-Row"},t);e(n.value,r)}return t},c=function(t){return o.create("div",{className:l+"Route-Header",id:"route"+t.objId,innerHTML:s.getRouteHTML(t,l)})},v=function(a){for(var i=o.create("div",{className:l+"Route-ManeuversAndNotes"}),s=a.notes.iterator,d=s.done,u=d?999999999:s.value.distance,c=a.itinerary.maneuvers.iterator,v=c.done,g=0;!v||!d;){var p=o.create("div",{className:l+"Route-ManeuversAndNotes-Row"},i);if(g<=u){if(!v){p.className=l+"Route-Maneuvers-Row",o.create("div",{className:l+"Route-ManeuversAndNotes-IconCell TravelNotes-ManeuverNote-"+c.value.iconName},p);var T="<div>"+c.value.instruction+"</div>";0<c.value.distance&&(T+="<div>"+n.getText("HTMLViewsFactory - ToNextInstruction",{distance:r.formatDistance(c.value.distance),duration:r.formatTime(c.value.duration)})+"</div>"),o.create("div",{className:l+"Route-ManeuversAndNotes-Cell",innerHTML:T},p),p.objId=t("../data/ObjId")(),p.latLng=a.itinerary.itineraryPoints.getAt(c.value.itineraryPointObjId).latLng,p.maneuverObjId=c.value.objId,g+=c.value.distance,(v=c.done)&&(g=999999999)}}else d||(p.className=l+"Route-Notes-Row",e(s.value,p),p.objId=t("../data/ObjId")(),p.latLng=s.value.latLng,p.noteObjId=s.value.objId,u=(d=s.done)?999999999:s.value.distance)}return i},g=function(t){var e="";return""!==t.itinerary.provider&&""!==t.itinerary.transitMode&&(e=n.getText("HTMLViewsFactory - Route footer",{provider:t.itinerary.provider,transitMode:n.getText("HTMLViewsFactory - TransitMode "+t.itinerary.transitMode)})),o.create("div",{className:l+"RouteFooter",innerHTML:e})},p=function(){return o.create("div",{className:l+"TravelFooter",innerHTML:n.getText("HTMLViewsFactory - Travel footer")})},T=function(){var t=o.create("div",{className:l+"Travel"});t.appendChild(d()),t.appendChild(u());for(var e=a.travel.routes.iterator;!e.done;){var n=a.config.routeEditor.displayEditionInHTMLPage&&e.value.objId===a.editedRoute.routeInitialObjId;t.appendChild(c(n?a.editedRoute:e.value)),t.appendChild(v(n?a.editedRoute:e.value)),t.appendChild(g(n?a.editedRoute:e.value))}return t.appendChild(p()),t};return{set classNamePrefix(t){l=t},get classNamePrefix(){return l},get travelHeaderHTML(){return d()},get travelNotesHTML(){return u()},get routeHeaderHTML(){return c(a.editedRoute)},get routeManeuversAndNotesHTML(){return v(a.editedRoute)},get routeFooterHTML(){return g(a.editedRoute)},get travelFooterHTML(){return p()},get travelHTML(){return T()}}})}()},{"../UI/HTMLElementsFactory":12,"../UI/Translator":19,"../core/NoteEditor":26,"../core/RouteEditor":27,"../data/DataManager":31,"../data/ObjId":36,"../util/Utilities":42}],14:[function(t,e,o){!function(){"use strict";var o=t("./Translator")(),a=t("../data/DataManager")(),n=function(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()},r=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-ItineraryHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-ItineraryDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-ItineraryButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-ItineraryExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-Control-ItineraryExpandButton").title=e?o.getText("ItineraryEditorUI - Show"):o.getText("ItineraryEditorUI - Hide")},i=function(e){e.stopPropagation();for(var o=e.target;!o.latLng;)o=o.parentNode;t("../core/MapEditor")().zoomToPoint(o.latLng)},s=function(e){e.stopPropagation(),e.preventDefault();for(var o=e.target;!o.latLng;)o=o.parentNode;o.maneuverObjId?t("../core/NoteEditor")().newManeuverNote(o.maneuverObjId,o.latLng):o.noteObjId&&t("../core/NoteEditor")().editNote(o.noteObjId)},l=function(e){e.stopPropagation(),t("../core/MapEditor")().addItineraryPointMarker(e.target.objId,e.target.latLng)},d=function(e){e.stopPropagation(),t("../core/MapEditor")().removeObject(e.target.objId)},u=function(e){e.stopPropagation(),a.routing.transitMode=e.target.transitMode,document.getElementsByClassName("TravelNotes-Control-ActiveTransitModeImgButton")[0].classList.remove("TravelNotes-Control-ActiveTransitModeImgButton"),e.target.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),t("../core/RouteEditor")().startRouting()},c=function(e){e.stopPropagation(),a.routing.provider=e.target.provider,document.getElementsByClassName("TravelNotes-Control-ActiveProviderImgButton")[0].classList.remove("TravelNotes-Control-ActiveProviderImgButton"),e.target.classList.add("TravelNotes-Control-ActiveProviderImgButton");var o=a.providers.get(e.target.provider);o.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-carImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),o.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-bikeImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),o.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),a.providers.get(e.target.provider).transitModes[a.routing.transitMode]||(o.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").click():o.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").click():o.transitModes.car&&document.getElementById("TravelNotes-Control-carImgButton").click()),t("../core/RouteEditor")().startRouting()};void 0!==e&&e.exports&&(e.exports=function(){var e=function(e){if(!document.getElementById("TravelNotes-Control-ItineraryDataDiv")){var i=t("./HTMLElementsFactory")(),s=i.create("div",{id:"TravelNotes-Control-ItineraryHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);i.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-Control-ItineraryExpandButton",className:"TravelNotes-Control-ExpandButton"},s).addEventListener("click",r,!1),i.create("span",{innerHTML:o.getText("ItineraryEditorUI - Itinerary and notes"),id:"TravelNotes-Control-ItineraryHeaderText",className:"TravelNotes-Control-HeaderText"},s),i.create("div",{id:"TravelNotes-Control-ItineraryDataDiv",className:"TravelNotes-Control-DataDiv"},e).addEventListener("wheel",n,!1);var l=i.create("div",{id:"TravelNotes-Control-ItineraryButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e),d=i.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESkaC0SxrgAABMdJREFUSMfNl1loVGcYhp//n+WcZmbiJE4WjVKVaLWOGxglilFTSmYUF1ILKiIILSjplQiKS65EXG4UvBGrQvVCUAdjoRrEGmtwjQbtWKlpEsTGGDMxkzKTzHr+XiRucbK4ts/lOd/5X853vuU9gj4YN+48Dx58DUBOzrmhnZ0qXykWJBKqKJlkYjyusgAsFtFqMnHPbBa/CcEvaWnir5YWT1vvM3ojUl2cPv1XamqK8fv/MBcWPtwfDhuLlWKYUvSLECAEzTabPHP16uc/uN1fJp6fNShhpRROZ+WSzk7jVDyuTLwDFotIpqXJb4LBkgohRP/Cbvc5/H6krhsnolFVOtAbDoQQoGnCF4nIb91uDL/f8+KefDXQ70e6XOpIJPL+ot2Zg0hElbpc6ojf/7qWBPB6q1FKoevqRCBgrOYDEwgYq3VdnVBK4fVWd2cjL6+SpqYSnM5zi4PBZAUfEafTtCQY9JzJy6tENjWVsH79ZWs4bJziIxMOG6fWr79sbWoq6S4uTTt7MBo1vuMToGnyx2jU+71ITz/rCoWM3w2D3AFKBUj0NIL5nYWl5IndLidJw2CsUgOJwtSp6SQSC7h5czZO50vhIUPMTJrkYMIEO8OHa4Op9FzDYKyUEs9gWqelJUpbm8GcOdcJBmOAARjEYgZFRUOoqZnNyJGDEkZKPOZIRM0bTIricUU8blBePhaQKAXJZBzDUMyYkcnly21cvx7sPRpSEomoeWZgQv9hSUAxYoSD8+efsmdPIxkZVgBMJrDZTKxdO4YLF56Sm/sZT5509jzX76SdYI7FurdMKoqKMti8eQyZmVakFOTkaGzaFGP79gZCoSSaJpk82UFl5VN2727k+PEpxGIGHR0Jdu5s4Natf1KeG4uprD7Lc86cDPbuHc/y5Xd4/DhKa+tXNDZ2cfJkC9euFXLw4EMMA6ZNG8KOHfUcPjyZKVPSWbnyNg0NEXy+aaxadYcbN1KLS6tVtKZK75YtY1ix4i51dZ0sWpTF3bshurqSZGdruN3VLFyYS3HxUEKhJAsXZpGbq1Faeovt28dz716IpUtvs21bfs+neh2rVbSagftAVu+edTotdHUl0XVJdraV+fOvcejQJPLzbSj1lHXr/GiapL09gc83lWg0ycyZDk6ffozNZiIUSpKdbe3p/ze4LzVNVKVIBJcuteHxuOjqSrJvXyNpaSaKi134fM2AoL6+C6/Xxf79X7Bx45/Y7RZ27XpIeXkdoVCcuXMzuXIldZVrmqgSdvvZwnDYuNK7l9PTzVRVzUAIQV1dmLlzh7Jhw32OHm16ZY0r8vPTSCQUXm8WW7fmc/p0C263g5wcK7NmXePZs/gbO9pmk7MGGJkJvN5cRo9O4+efW3j0KNKXaQEMJk50sGzZMOrrwxw79nfKlno+MgexJFR/Lumt458vCQlQVmYvs1hEgj79oHiLNdB3vMUiEmVl9rL/3gh4vdW0t5ec0XXp+1iiui597e0lZ7zeal4YgZecky6XOvKhfZfLJX8KBMQa8BgpXabbjREIiDW6LnxCvL+gEKDrwhcIiDVuN8b/wtCnXJ4FBRfp6PBU1NaO0h0OeUBKmgeTASFASpodDnmgtnaU3tHhqSgouDj4f6dP8dP2L6C7Ld6Z4dDBAAAAAElFTkSuQmCC",id:"TravelNotes-Control-bikeImgButton",className:"TravelNotes-Control-ImgButton"},l);d.transitMode="bike",d.addEventListener("click",u,!1);var v=i.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESo7bADyMwAABNlJREFUSMe1V19oU1cY/52Te5Ob3DR/SfzTNNCufxRXxmarONCnPbi+ykYrFdRSkeJLX5ykZcKcFfG5oIJ2Y2sVFZQ+iPoiUhC128OIiJrUlgQTm9o0t23SJufmnj2k2ura5syx7ynknu/7nd93vr8E6wghBJxzAEAgAEsmc3pToWD1y3L6M8NQfABA6eIUY54xs3kh5Xb3JONx5D/WXdX2Wh9crkPIZAbAOVBRcbpvYaHuO87lDZyTCs7lFaochDAQwucANmmzRa7PzfWECFm2IQTsdrdiZuYqHI5quVg80J7P113WdR+AIsTEBEmagsUSOayq539PpVLM5WpFJnO1POOtW+GMRH4dKRa9jZxTABz/TggIMSDLU+Fg8NDuaBTaxyfoux8ORxsAwG7vrI5Ehl7pur+Rc/IJoCX3c05QKGxsnJgYemW3d1avxPgH42AQzkRi6JWuOz3ljReX7k3KnpQkLb158/6aWGyZOS0F0kF4vX45mRwY0XV3WdCGBhsePvwa3d1BAEZZYF13e5LJgRGv1y87nQdLjCmlMAwDqvrj4Wx2x6XyDAw8eLADe/b4AQCqehu5nJj7bbYnHbncT5cppaCGYYBzIJ+vu7TiydcNnP7+GBKJRQwPJ5HL6YLvTlEo1F3iHDAMo4Rkt5/qK6UMFwK+du0NurvDePt2EQ0NdkE9Dl33wW4/1QcApKoKltevrz01DLVWNGKbmhwYHd1dCrEiR0vLY9y7Ny0UaJRmo5WV339OZ2b6NgGyXzRRVFXC4OCXKwwBd+/uRH//VkHmsn9mpm8TZUzxcU4comzb2zciEFCg6yWQZ8/mcOJEGF1dNaivV8tb4MTBmOKjkpSuLdXe8lJZacb5819g374/QEiphJpMBGfPvlxiTwSAZUjSdC0tdZnyCiYTwfBwMx49SuPOnSkA7P3/7/QZM4SC0zCsPkn0bX0+GU+eTCMUGgNAcO7cGEwmCbOzFITI2Lv3ESYmFsWruar2tmWzu4bEjhtLxY4jn/8G2ayByck8mpsfY36+CPEAfbif6ronSggTLgKAgQsXtmF+nuLIkTC2bHGhpcUj3EwIYdB1b5TK8uIUIXxW9LbBoBXt7VW4ciWOGzeSuHnzNQYHvxJ3MeGzZvPiFHW7Q0mApcTUiujtrYHVChw79hyAjOPHX6JYJLh4cZtQwyCEpVyuUJLG48hbrS+uA6aySvX1Kjo7q9HV9fS9a6PRHG7dSqCtLYBAwFp2OlGUF9fjceRJKbcAWf6N67p3zbciBBgZ2Ym6OjsaGh4gk1luDmYzQT7/LUKhZzhzZnyN0kkgSdNg7AAhBKCUUhACWCyRjvVc1dxcgV273Dh58jkymQ+DsVAwcPToX1AUsm5GmM2RjiXQ0tVcroMAbsvZ7Nk/GdvYuNoF/H4ZGzZYEA7PrcpIUSgoBXI5Y9VskOU3Yafzh+2MtTBN++W/jD7iIklauqpqf834+Eejz7tBLBaDpij3myRJS4sNBeXzXpK0tKLcbxofh+Z0tq0/3tbWwhmLDYww5vv/x9vlDaIV0Sg0jye03WYbPSxJ0xBJtQ8H+mlus412eDwntkej0Fyu1k9dYX7uW1ioX3OFoZQB4HOEsEmr9RNXmLWWtspKWDRt9aVN1z1jsryQcjh6komE2NL2N0SHF0QJfjNNAAAAAElFTkSuQmCC",id:"TravelNotes-Control-pedestrianImgButton",className:"TravelNotes-Control-ImgButton"},l);v.transitMode="pedestrian",v.addEventListener("click",u,!1);var g=i.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESgBmDpJAwAABQBJREFUSMe9V09MFFcY/703szOz7PLP2WVBV6rtdm21HqhG2wiCh8bL2jWhsl71IhqJJ4oHL4RIxKP1HzESLh4MEGPkoAeNYRWtGkPShGRF+aeFld2psd0BZnZmXg+LW4SdrW3EX/Iub775fe/7977vEdigrCyMmZnrAABZbvGoavkGSh0hy3LtNAzuS57nZAAwTVPhOHOEUnXAstL9Ltd0TFFOJ5dyLAXJtSnLMhRFwaNHoDt3nj2v66vDjHHljDkAsIXf2CKKzB4haRBixgVh6vrAwNEj27bB8ng8SCaTH6aYMcDtPh3StM/6DKNIACz8N1Dw/J+6KI7Xp1It/YTkkliEwsJmnD8PIopdvbOzX90wDPf/UAoAFgzDLczOfn1Dkrp6T5wAKSpqtre4tRXk5MkLV3W9ch8+IgRhsqel5XCkrS0bn4xiWZaRTCqQpK5eTfPVYwUgiq/75ucP/uT1ZmJOvd4wFEWBy9UR0nXPiigFAF331LtcHaFkMomysnDG4mgUdNeuq3OZmK4ceD6lP34ccVZVwSIZN5y9qGlfHLJPJAa/X4LbzeUlnp21MDk5Z1csAChE8XmnpjU1Eln+2fPmzXe/WZZYbkcoyxympn6AaaahKCrIkvpgjKGkpACSJCAQuI2JibR9oVEtXlz862ZeVSs2MMaV57NkzRoHBIFi06aHGB5+m/XC4sIIBAoxMrILfr+YVzFjXPncXPkGSikfytxIeapyIQKHDlUAAIJBN3p7t+Lata0IBt0AGBobVy/IsrxcjDlACL+Htyx3zT+nz3GnEqCyUkJ39wSOHYvh7t1vUVvrz37fu3cNotHfUVs7BElywO+XAKj5VIMxdw01TS5onwwWHjzYjp6ebaiokFBdXYJUSl8mNT9voq6uBH6/hO7uLXjy5HtQamsKTJMLUo7j5NwWMxw44Mf27TIKCnjs3u1DNFqDVGq5bDJp4M6dHQiHV6OggMeWLaU4enQt7Hg5jltF88WjqIjPNo13aGj4fJnc/v3r32swAFBcnD9vqGmaSm5XE5w58xINDYMgBKiru4ebN+NIpxlGR1WMjWXW6KgKTbMwOKigunoAhACHDz/CqVNjsOM1TVPhBOHHsGG4KnOfK41z577BunWFcDgscByDzyfh9u04Xr5UMTmZWT6fhFevVAQCBaiqKkVpKYfLl6fzNI3UEE9pKgr4duSOB0EqZQAAVNXAyIiKp0/fgudJ1qWEAJcujYEQAll2LMiaiwaG5ZyEpKK8ZRn9hKSPM8bnul3R1TWJUGgtLlyYwtDQX3njtn69E01NQVy58gqMEZvyTIMxo586ndMxQsy4Hdn4eBr37ycwPj6/YIH9mprScO9eAs+eaXnuBTPudE7HFprELxc1LZCnSVhLh5W804e9LIUgPO/U9aZGAgDDw6CbN1+dM82VbYscl9JjsYgzEIBFy8rC2LgRlihO1BNirphSQkyI4nh9IAArOwh4vV7MzCQ+7egDAIlEAoQAra0H9wnCRM/HVioIEz2trQf3EYLsjP1eFrS3N7Pjx49ERPF138dwe8a9r/va2o5E2tub2QcO9B0hTVv3aQb6d/B4ZKhqS/+tWxGnJL3opFSLE2IsOifJcXYCQgxQqsUl6UXn4GDEqaot/V6v58PfTpmECyORWPpo4/dYlrvGMLggz3OrFh5tf1BqPuO4VNSyjBsuVzymKB3/+mj7G1dPIltjqpC6AAAAAElFTkSuQmCC",id:"TravelNotes-Control-carImgButton",className:"TravelNotes-Control-ImgButton"},l);if(g.transitMode="car",g.addEventListener("click",u,!1),a.providers){var p=!1;a.providers.forEach(function(t){var e=i.create("img",{src:"data:image/png;base64,"+t.icon,id:"TravelNotes-Control-"+t.name+"ImgButton",className:"TravelNotes-Control-ImgButton",title:t.name},l);e.provider=t.name.toLowerCase(),e.addEventListener("click",c,!1),p||(e.classList.add("TravelNotes-Control-ActiveProviderImgButton"),a.routing.provider=e.provider,p=!0,t.transitModes.bike?(d.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),a.routing.transitMode="bike"):t.transitModes.pedestrian?(v.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),a.routing.transitMode="pedestrian"):t.transitModes.car&&(g.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),a.routing.transitMode="car"),t.transitModes.car||g.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.pedestrian||v.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.bike||d.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"))})}}},v=function(){var e=t("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Control-";var o=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(o){var a=document.getElementsByClassName("TravelNotes-Control-Route-Header")[0];a&&o.removeChild(a),o.appendChild(e.routeHeaderHTML);var n,r,u,c=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(c){for(r=c.childNodes,n=0;n<r.length;n++)(u=r[n]).removeEventListener("click",i,!1),u.removeEventListener("contextmenu",s,!1),u.removeEventListener("mouseenter",l,!1),u.removeEventListener("mouseleave",d,!1);o.removeChild(c)}if(o.appendChild(e.routeManeuversAndNotesHTML),c=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0])for(r=c.childNodes,n=0;n<r.length;n++)(u=r[n]).addEventListener("click",i,!1),u.addEventListener("contextmenu",s,!1),u.addEventListener("mouseenter",l,!1),u.addEventListener("mouseleave",d,!1)}};return{createUI:function(t){e(t)},setItinerary:function(){v()},setProvider:function(t){var e=document.getElementById("TravelNotes-Control-"+t+"ImgButton");e&&e.click()},setTransitMode:function(t){console.log(t);var e=document.getElementById("TravelNotes-Control-"+t+"ImgButton");e&&e.click()}}})}()},{"../UI/HTMLViewsFactory":13,"../core/MapEditor":25,"../core/NoteEditor":26,"../core/RouteEditor":27,"../data/DataManager":31,"./HTMLElementsFactory":12,"./Translator":19}],15:[function(t,e,o){!function(){"use strict";var o,a,n=t("../UI/Translator")(),r={editionButtons:[],preDefinedIconsList:[]},i={editionButtons:[],preDefinedIconsList:[]},s={editionButtons:[],preDefinedIconsList:[]},l=function(){return 0===document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value.length?(document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=n.getText("Notedialog - empty icon content"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),!1):(o.iconWidth=document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value,o.iconHeight=document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value,o.iconContent=document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value,o.popupContent=document.getElementById("TravelNotes-NoteDialog-TextArea-PopupContent").value,o.tooltipContent=document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value,o.address=document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value,o.url=document.getElementById("TravelNotes-NoteDialog-InputText-Link").value,o.phone=document.getElementById("TravelNotes-NoteDialog-InputText-Phone").value,t("../core/NoteEditor")().endNoteDialog(o,a),!0)};void 0!==e&&e.exports&&(e.exports=function(e,d,u){var c=function(){s.preDefinedIconsList=i.preDefinedIconsList.concat(r.preDefinedIconsList),s.preDefinedIconsList.sort(function(t,e){return t.name.localeCompare(e.name)});var t=0;for(t=N.length-1;t>=0;t--)N.remove(counter);for(t=0;t<s.preDefinedIconsList.length;t++){var e=T.create("option",{text:s.preDefinedIconsList[t].name});N.add(e)}},v=function(t){t.forEach(function(t){T.create("button",{type:"button",innerHTML:t.title||"?",htmlBefore:t.htmlBefore||"",htmlAfter:t.htmlAfter||"",className:"TravelNotes-NoteDialog-EditorButton"},f).addEventListener("click",g,!1)})},g=function(t){if(I){var e=t.target.htmlAfter&&0<t.target.htmlAfter.length,o=I.selectionStart,a=I.selectionEnd,n=I.value;I.value=n.substring(0,o)+(e?t.target.htmlBefore+n.substring(o,a)+t.target.htmlAfter:t.target.htmlBefore)+n.substring(a),I.setSelectionRange(e||o===a?o+t.target.htmlBefore.length:o,(e?a:o)+t.target.htmlBefore.length),I.focus()}};o=e,a=d;var p=t("../UI/BaseDialog")();p.title=n.getText("NoteDialog - Title"),p.addClickOkButtonEventListener(l);var T=t("./HTMLElementsFactory")(),m=T.create("div",{id:"TravelNotes-NoteDialog-MainDataDiv"},p.content),f=T.create("div",{className:"TravelNotes-NoteDialog-ToolbarDiv",id:"TravelNotes-NoteDialog-ToolbarDiv"},m),N=T.create("select",{className:"TravelNotes-NoteDialog-Select",id:"TravelNotes-NoteDialog-IconSelect"},f);N.addEventListener("change",function(t){N.selectedIndex;var e=s.preDefinedIconsList[N.selectedIndex];b.value=e.width,C.value=e.height,D.value=e.icon,R.value=e.tooltip},!1);var I=null,L=T.create("div",{id:"TravelNotes-NoteDialog-OpenEditorFileDiv"},f),E=T.create("input",{id:"TravelNotes-NoteDialog-OpenEditorFileInput",type:"file",accept:".json"},L);E.addEventListener("change",function(t){var e=new FileReader;e.onload=function(t){try{var o=JSON.parse(e.result);r.editionButtons=r.editionButtons.concat(o.editionButtons),r.preDefinedIconsList=r.preDefinedIconsList.concat(o.preDefinedIconsList),v(o.editionButtons),c()}catch(t){}},t.target.files[0].name,e.readAsText(t.target.files[0])},!1);var h=T.create("div",{id:"TravelNotes-NoteDialog-OpenStyleFakeDiv"},L);T.create("button",{id:"TravelNotes-NoteDialog-OpenEditorFileButton",className:"TravelNotes-NoteDialog-EditorButton",title:n.getText("TravelEditorUI - Open travel"),innerHTML:"&#x23CD;"},h).addEventListener("click",function(){E.click()},!1),v([{title:"div",htmlBefore:"<div>",htmlAfter:"</div>"},{title:"p",htmlBefore:"<p>",htmlAfter:"</p>"},{title:"span",htmlBefore:"<span>",htmlAfter:"</span>"},{title:"a",htmlBefore:'<a target="_blank" href="">',htmlAfter:"</a>"}]),v(i.editionButtons),v(r.editionButtons),c();var y=T.create("div",{className:"TravelNotes-NoteDialog-DataDiv",id:"TravelNotes-NoteDialog-DimensionsDataDiv"},m);T.create("text",{data:n.getText("NoteDialog - Icon width")},y);var b=T.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-WidthNumberInput"},y);b.value=e.iconWidth,T.create("text",{data:n.getText("NoteDialog - Icon height")},y);var C=T.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-HeightNumberInput"},y);C.value=e.iconHeight,T.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",id:"TravelNotes-NoteDialog-IconContentTitleDiv",innerHTML:n.getText("NoteDialog - IconHtmlContentTitle")},m);var D=T.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-IconHtmlContent"},m);D.addEventListener("focus",function(t){I=D},!1),D.value=e.iconContent,T.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:n.getText("NoteDialog - PopupContentTitle")},m);var x=T.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-PopupContent"},m);x.addEventListener("focus",function(t){I=x},!1),x.value=e.popupContent,T.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:n.getText("NoteDialog - TooltipTitle")},m);var R=T.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Tooltip"},m);R.addEventListener("focus",function(t){I=R},!1),R.value=e.tooltipContent,T.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:n.getText("NoteDialog - AdressTitle")},m);var M=T.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Adress"},m);M.addEventListener("focus",function(t){I=M},!1),M.value=e.address,T.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:n.getText("NoteDialog - LinkTitle")},m);var j=T.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Link"},m);j.addEventListener("focus",function(t){I=null},!1),j.value=e.url,T.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:n.getText("NoteDialog - PhoneTitle")},m);var B=T.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Phone"},m);if(B.addEventListener("focus",function(t){I=B},!1),B.value=e.phone,0===i.preDefinedIconsList.length){var A=new XMLHttpRequest;A.onreadystatechange=function(t){if(this.readyState===A.DONE)if(200===this.status)try{i=JSON.parse(this.responseText),v(i.editionButtons),i.preDefinedIconsList.push({name:"",icon:"",tooltip:"",width:40,height:40}),c()}catch(t){console.log("Error reading TravelNotesNoteDialog.json")}else console.log("Error sending request for TravelNotesNoteDialog.json")},A.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesNoteDialog.json",!0),A.send(null)}t("../data/DataManager")().config.note.reverseGeocoding&&""===e.address&&u&&t("../core/GeoCoder")().getAddress(e.lat,e.lng,function(t){M.value=t},this),p.center()})}()},{"../UI/BaseDialog":8,"../UI/Translator":19,"../core/GeoCoder":23,"../core/NoteEditor":26,"../data/DataManager":31,"./HTMLElementsFactory":12}],16:[function(t,e,o){!function(){"use strict";var o=t("./Translator")(),a=null,n=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-RouteHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title=e?o.getText("RouteEditorUI - Show"):o.getText("RouteEditorUI - Hide")},r=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").title=e?o.getText("RouteEditorUI - Reduce the list"):o.getText("RouteEditorUI - Expand the list")};void 0!==e&&e.exports&&(e.exports=function(){var e=function(e){if(!document.getElementById("TravelNotes-Control-RouteDataDiv")){var i=t("./HTMLElementsFactory")(),s=i.create("div",{id:"TravelNotes-Control-RouteHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);i.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-Control-RouteExpandButton",className:"TravelNotes-Control-ExpandButton"},s).addEventListener("click",n,!1),i.create("span",{innerHTML:o.getText("RouteEditorUI - Waypoints"),id:"TravelNotes-Control-RouteHeaderText",className:"TravelNotes-Control-HeaderText"},s);var l=i.create("div",{id:"TravelNotes-Control-RouteDataDiv",className:"TravelNotes-Control-DataDiv"},e);(a=t("./SortableList")({minSize:0,listStyle:"LimitedSort",id:"TravelNotes-Control-RouteWaypointsList"},l)).container.addEventListener("SortableListDelete",function(e){e.stopPropagation(),t("../core/RouteEditor")().removeWayPoint(e.itemNode.dataObjId)},!1),a.container.addEventListener("SortableListUpArrow",function(e){e.stopPropagation(),t("../core/RouteEditor")().swapWayPoints(e.itemNode.dataObjId,!0)},!1),a.container.addEventListener("SortableListDownArrow",function(e){e.stopPropagation(),t("../core/RouteEditor")().swapWayPoints(e.itemNode.dataObjId,!1)},!1),a.container.addEventListener("SortableListChange",function(e){e.stopPropagation(),t("../core/RouteEditor")().renameWayPoint(e.dataObjId,e.changeValue)},!1),a.container.addEventListener("SortableListDrop",function(e){e.stopPropagation(),t("../core/RouteEditor")().wayPointDropped(e.draggedObjId,e.targetObjId,e.draggedBefore)},!1);var d=i.create("div",{id:"TravelNotes-Control-RouteButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e);i.create("div",{id:"TravelNotes-Control-ExpandWayPointsListButton",className:"TravelNotes-Control-Button",title:o.getText("RouteEditorUI - Expand the list"),innerHTML:"&#x25bd;"},d).addEventListener("click",r,!1),i.create("div",{id:"TravelNotes-Control-CancelRouteButton",className:"TravelNotes-Control-Button",title:o.getText("RouteEditorUI - Cancel"),innerHTML:"&#x274c"},d).addEventListener("click",function(e){e.stopPropagation(),t("../core/RouteEditor")().cancelEdition()},!1),i.create("div",{id:"TravelNotes-Control-SaveRouteButton",className:"TravelNotes-Control-Button",title:o.getText("RouteEditorUI - Save"),innerHTML:"&#x1f4be;"},d).addEventListener("click",function(e){e.stopPropagation(),t("../core/RouteEditor")().saveEdition()},!1),i.create("div",{id:"TravelNotes-Control-gpxButton",className:"TravelNotes-Control-Button",title:o.getText("RouteEditorUI - gpx"),innerHTML:"gpx"},d).addEventListener("click",function(e){e.stopPropagation(),t("../core/RouteEditor")().saveGpx()},!1),i.create("div",{id:"TravelNotes-Control-ReverseWayPointsButton",className:"TravelNotes-Control-Button",title:o.getText("RouteEditorUI - Invert waypoints"),innerHTML:"&#x21C5;"},d).addEventListener("click",function(e){e.stopPropagation(),t("../core/RouteEditor")().reverseWayPoints()},!1),i.create("div",{id:"TravelNotes-Control-RemoveAllWayPointsButton",className:"TravelNotes-Control-Button",title:o.getText("RouteEditorUI - Delete all waypoints"),innerHTML:"&#x267b;"},d).addEventListener("click",function(e){e.stopPropagation(),t("../core/RouteEditor")().removeAllWayPoints()},!1)}},i=function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Masquer",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.remove("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.remove("TravelNotes-Control-HiddenList")},s=function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25b6;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Afficher",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.add("TravelNotes-Control-HiddenList")},l=function(){if(a.removeAllItems(),-1!==t("../data/DataManager")().editedRoute.routeInitialObjId)for(var e=t("../data/DataManager")().editedRoute.wayPoints.iterator;!e.done;){var n=e.first?"A":e.last?" B":e.index,r=e.first?o.getText("RouteEditorUI - Start"):e.last?o.getText("RouteEditorUI - End"):o.getText("RouteEditorUI - Via");a.addItem(e.value.UIName,n,r,e.value.objId,e.last)}};return{createUI:function(t){e(t)},expand:function(){i()},reduce:function(){s()},setWayPointsList:function(){l()}}})}()},{"../core/RouteEditor":27,"../data/DataManager":31,"./HTMLElementsFactory":12,"./SortableList":18,"./Translator":19}],17:[function(t,e,o){!function(){"use strict";var o=t("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(e){var a=t("../UI/ColorDialog")(e.color);a.title=o.getText("RoutePropertiesDialog - Title"),a.addClickOkButtonEventListener(function(){return e.color=a.getNewColor(),e.width=parseInt(s.value),e.chain=d.checked,t("../core/MapEditor")().editRoute(e),t("../core/RouteEditor")().chainRoutes(),t("../UI/TravelEditorUI")().setRoutesList(),t("../core/TravelEditor")().changeTravelHTML(),!0});var n=t("./HTMLElementsFactory")(),r=n.create("div",{id:"TravelNotes-RoutePropertiesDialog-MainDataDiv"},a.content),i=n.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-WithDiv"},r);n.create("text",{data:o.getText("RoutePropertiesDialog - Width")},i);var s=n.create("input",{type:"number",id:"TravelNotes-RoutePropertiesDialog-WidthInput"},i);s.value=e.width,s.min=1,s.max=40;var l=n.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-ChainDiv"},r),d=n.create("input",{type:"checkbox",id:"TravelNotes-RoutePropertiesDialog-ChainInput"},l);return d.checked=e.chain,n.create("label",{for:"TravelNotes-RoutePropertiesDialog-ChainInput",innerHTML:o.getText("RoutePropertiesDialog - Chain")},l),a})}()},{"../UI/ColorDialog":9,"../UI/Translator":19,"../UI/TravelEditorUI":20,"../core/MapEditor":25,"../core/RouteEditor":27,"../core/TravelEditor":29,"./HTMLElementsFactory":12}],18:[function(t,e,o){!function(){"use strict";var o=t("../UI/Translator")(),a=function(t){t.stopPropagation();try{t.dataTransfer.setData("Text",t.target.dataObjId),t.dataTransfer.dropEffect="move"}catch(t){}},n=function(t){t.preventDefault();for(var e=t.target;!e.dataObjId;)e=e.parentElement;var o=e.getBoundingClientRect(),a=new Event("SortableListDrop");a.draggedObjId=parseInt(t.dataTransfer.getData("Text")),a.targetObjId=e.dataObjId,a.draggedBefore=t.clientY-o.top<o.bottom-t.clientY,e.parentNode.dispatchEvent(a)},r=function(t){var e=new Event("SortableListDelete");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},i=function(t){var e=new Event("SortableListUpArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},s=function(t){var e=new Event("SortableListDownArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},l=function(t){var e=new Event("SortableListRightArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},d=function(t){console.log("onChange");var e=new Event("SortableListChange");e.dataObjId=t.target.parentNode.dataObjId,e.changeValue=t.target.value,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},u=function(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()},c=function(e,c){var v=t("./HTMLElementsFactory")();this.items=[],this.removeAllItems=function(){for(var t=0;t<this.items.length;t++)this.container.removeChild(this.items[t]);this.items.length=0},this.addItem=function(t,e,n,u,c){t=t||"",e=e||"",n=n||"",u=u||-1;var g=v.create("div",{draggable:!1,className:"TravelNotes-SortableList-Item"});v.create("div",{className:"TravelNotes-SortableList-ItemTextIndex",innerHTML:e},g),v.create("input",{type:"text",className:"TravelNotes-SortableList-ItemInput",placeholder:n,value:t},g).addEventListener("change",d,!1),v.create("div",{className:"TravelNotes-SortableList-ItemUpArrowButton",title:o.getText("SortableList - Move up"),innerHTML:String.fromCharCode(8679)},g).addEventListener("click",i,!1),v.create("div",{className:"TravelNotes-SortableList-ItemDownArrowButton",title:o.getText("SortableList - Move down"),innerHTML:String.fromCharCode(8681)},g).addEventListener("click",s,!1);var p=v.create("div",{className:"TravelNotes-SortableList-ItemRightArrowButton",title:o.getText("SortableList - Edit"),innerHTML:String.fromCharCode(8688)},g);"AllSort"===this.options.listStyle&&p.addEventListener("click",l,!1),v.create("div",{className:"TravelNotes-SortableList-ItemDeleteButton",title:o.getText("SortableList - Delete"),innerHTML:"&#x267b;"},g).addEventListener("click",r,!1),g.dataObjId=u,this.items.push(g),("LimitedSort"!==this.options.listStyle||1<this.items.length)&&!c&&(g.draggable=!0,g.addEventListener("dragstart",a,!1),g.classList.add("TravelNotes-SortableList-MoveCursor")),this.container.appendChild(g)},this._create=function(t,e){this.options={minSize:2,listStyle:"AllSort",id:"TravelNotes-SortableList-Container"};for(var o in t)this.options[o]=t[o];"LimitedSort"===this.options.listStyle&&2>this.options.minSize&&(this.options.minSize=0),this.container=v.create("div",{id:t.id,className:"TravelNotes-SortableList-Container"}),this.container.classList.add(this.options.listStyle),this.container.addEventListener("drop",n,!1),this.container.addEventListener("wheel",u,!1),e&&e.appendChild(this.container);for(var a=0;a<this.options.minSize;a++)this.addItem()},this._create(e,c)};void 0!==e&&e.exports&&(e.exports=function(t,e){return new c(t,e)})}()},{"../UI/Translator":19,"./HTMLElementsFactory":12}],19:[function(t,e,o){(function(t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return t.translations||(t.translations=new Map),{setTranslations:function(e){e.forEach(function(e){t.translations.set(e.msgid,e.msgstr)})},getText:function(e,o){var a=t.translations.get(e);return o&&a&&Object.getOwnPropertyNames(o).forEach(function(t){a=a.replace("{"+t+"}",o[t])}),a||e}}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(t,e,o){!function(){"use strict";var o=t("./Translator")(),a=t("../data/DataManager")(),n=null,r=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-ControlTravelButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-ControlTravelExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-ControlTravelExpandButton").title=e?o.getText("TravelEditorUI - Show"):o.getText("TravelEditorUI - Hide"),t.stopPropagation()},i=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandRoutesListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandRoutesListButton").title=e?o.getText("TravelEditorUI - Reduce the list"):o.getText("TravelEditorUI - Expand the list")},s=null,l=function(t){s&&(clearTimeout(s),s=null),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize")},d=function(){document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Minimize")},u=function(t){s=setTimeout(d,1e3)},c=function(t){var e=document.getElementById("TravelNotes-Control-MainDiv");10060===t.target.innerHTML.charCodeAt(0)?(t.target.innerHTML="&#x1f4cc;",e.addEventListener("mouseenter",l,!1),e.addEventListener("mouseleave",u,!1)):(t.target.innerHTML="&#x274c;",e.removeEventListener("mouseenter",l,!1),e.removeEventListener("mouseleave",u,!1))};void 0!==e&&e.exports&&(e.exports=function(){var e=function(e){if(!document.getElementById("TravelNotes-Control-TravelDataDiv")){var s=t("./HTMLElementsFactory")(),l=s.create("div",{id:"TravelNotes-Control-TravelHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);s.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-ControlTravelExpandButton",className:"TravelNotes-Control-ExpandButton"},l).addEventListener("click",r,!1),s.create("span",{innerHTML:o.getText("TravelEditorUI - Routes"),id:"TravelNotes-Control-TravelHeaderText",className:"TravelNotes-Control-HeaderText"},l),s.create("span",{innerHTML:"&#x274c;",id:"TravelNotes-Control-PinButton"},l).addEventListener("click",c,!1);var d=s.create("div",{id:"TravelNotes-Control-TravelDataDiv",className:"TravelNotes-Control-DataDiv"},e);(n=t("./SortableList")({minSize:0,id:"TravelNotes-Control-TravelRoutesList"},d)).container.addEventListener("SortableListDelete",function(e){e.stopPropagation(),t("../core/TravelEditor")().removeRoute(e.itemNode.dataObjId)},!1),n.container.addEventListener("SortableListUpArrow",function(e){e.stopPropagation(),t("../core/TravelEditor")().swapRoute(e.itemNode.dataObjId,!0)},!1),n.container.addEventListener("SortableListDownArrow",function(e){e.stopPropagation(),t("../core/TravelEditor")().swapRoute(e.itemNode.dataObjId,!1)},!1),n.container.addEventListener("SortableListRightArrow",function(e){e.stopPropagation(),t("../core/TravelEditor")().editRoute(e.itemNode.dataObjId)},!1),n.container.addEventListener("SortableListChange",function(e){e.stopPropagation(),t("../core/TravelEditor")().renameRoute(e.dataObjId,e.changeValue)},!1),n.container.addEventListener("SortableListDrop",function(e){e.stopPropagation(),t("../core/TravelEditor")().routeDropped(e.draggedObjId,e.targetObjId,e.draggedBefore)},!1);var u=s.create("div",{id:"TravelNotes-ControlTravelButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e);s.create("div",{id:"TravelNotes-Control-ExpandRoutesListButton",className:"TravelNotes-Control-Button",title:o.getText("TravelEditorUI - Expand the list"),innerHTML:"&#x25bd;"},u).addEventListener("click",i,!1),s.create("div",{id:"TravelNotes-Control-CancelTravelButton",className:"TravelNotes-Control-Button",title:o.getText("TravelEditorUI - Cancel travel"),innerHTML:"&#x274c"},u).addEventListener("click",function(e){e.stopPropagation(),t("../core/TravelEditor")().clear()},!1),s.create("div",{id:"TravelNotes-Control-SaveTravelButton",className:"TravelNotes-Control-Button",title:o.getText("TravelEditorUI - Save travel"),innerHTML:"&#x1f4be;"},u).addEventListener("click",function(e){e.stopPropagation(),t("../core/TravelEditor")().saveTravel()},!1);var v=s.create("div",{id:"TravelNotes-Control-OpenTravelDiv"},u),g=s.create("input",{id:"TravelNotes-Control-OpenTravelInput",type:"file",accept:".trv"},v);g.addEventListener("change",function(e){e.stopPropagation(),t("../core/TravelEditor")().openTravel(e)},!1);var p=s.create("div",{id:"TravelNotes-Control-OpenTravelFakeDiv"},v);s.create("div",{id:"TravelNotes-Control-OpenTravelButton",className:"TravelNotes-Control-Button",title:o.getText("TravelEditorUI - Open travel"),innerHTML:"&#x1F4C2;"},p).addEventListener("click",function(){g.click()},!1),s.create("div",{id:"TravelNotes-Control-OpenTravelRoadbookButton",className:"TravelNotes-Control-Button",title:o.getText("TravelEditorUI - Open travel roadbook"),innerHTML:'<a href="TravelNotesRoadbook.html?page='+a.UUID+'" target="_blank">&#x1F4CB;</a>'},u),s.create("div",{id:"TravelNotes-Control-AddRoutesButton",className:"TravelNotes-Control-Button",title:o.getText("TravelEditorUI - New route"),innerHTML:"+"},u).addEventListener("click",function(e){e.stopPropagation(),t("../core/TravelEditor")().addRoute()},!1)}},s=function(){n.removeAllItems();for(var t=a.travel.routes.iterator;!t.done;)n.addItem(t.value.name,t.value.chain?"&#x26d3;":"",o.getText("TravelEditorUI - Route"),t.value.objId,!1)};return{createUI:function(t){e(t)},setRoutesList:function(){s()}}})}()},{"../core/TravelEditor":29,"../data/DataManager":31,"./HTMLElementsFactory":12,"./SortableList":18,"./Translator":19}],21:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var e=document.getElementById("TravelNotes-Control-MainDiv");return e||(e=t("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv"}),t("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv-Title",innerHTML:"Travel&nbsp;&amp;&nbsp;Notes"},e),t("./TravelEditorUI")().createUI(e),t("./RouteEditorUI")().createUI(e),t("./ItineraryEditorUI")().createUI(e),t("./ErrorEditorUI")().createUI(e)),{get UI(){return e}}})}()},{"./ErrorEditorUI":11,"./HTMLElementsFactory":12,"./ItineraryEditorUI":14,"./RouteEditorUI":16,"./TravelEditorUI":20}],22:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{showError:function(e){t("../UI/ErrorEditorUI")().message='<span class="TravelNotes-Control-Error">'+e+"</span>",t("../UI/ErrorEditorUI")().expand()},clear:function(e){t("../UI/ErrorEditorUI")().message=""}}})}()},{"../UI/ErrorEditorUI":11}],23:[function(t,e,o){!function(){"use strict";var o=!1;void 0!==e&&e.exports&&(e.exports=function(){return{getAddress:function(e,a,n,r,i){if(!o){o=!0;var s="http://nominatim.openstreetmap.org/reverse?format=json&lat="+e+"&lon="+a+"&zoom=18&addressdetails=1&accept-language="+t("../data/DataManager")().config.language,l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){o=!1;var t;try{t=JSON.parse(this.responseText)}catch(t){return}var e="";void 0!==t.address.house_number&&(e+=t.address.house_number+" "),void 0!==t.address.road?e+=t.address.road+" ":void 0!==t.address.pedestrian&&(e+=t.address.pedestrian+" "),void 0!==t.address.village?e+=t.address.village:void 0!==t.address.town?e+=t.address.town:void 0!==t.address.city&&(e+=t.address.city),0===e.length&&(e+=t.address.country),n.call(r,e,i)}},l.open("GET",s,!0),l.send(null)}}}})}()},{"../data/DataManager":31}],24:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{setItinerary:function(){t("../UI/ItineraryEditorUI")().setItinerary()},setProvider:function(e){t("../UI/ItineraryEditorUI")().setProvider(e)},setTransitMode:function(e){t("../UI/ItineraryEditorUI")().setTransitMode(e)}}})}()},{"../UI/ItineraryEditorUI":14}],25:[function(t,e,o){!function(){"use strict";var o=t("../Data/DataManager")();void 0!==e&&e.exports&&(e.exports=function(){var e=function(t,e){e.objId=t,e.addTo(o.map),o.mapObjects.set(t,e)},a=function(t){var e=o.mapObjects.get(t);e&&(L.DomEvent.off(e),o.map.removeLayer(e),o.mapObjects.delete(t))},n=function(t){var e=L.latLng([90,180]),o=L.latLng([-90,-180]);return t.forEach(function(t){e.lat=Math.min(e.lat,t[0]),e.lng=Math.min(e.lng,t[1]),o.lat=Math.max(o.lat,t[0]),o.lng=Math.max(o.lng,t[1])}),L.latLngBounds(e,o)},r=function(t){var e=[];return t.itinerary.itineraryPoints.forEach(function(t){e.push(t.latLng)}),t.notes.forEach(function(t){e.push(t.latLng),e.push(t.iconLatLng)}),e};return{removeRoute:function(t,e,o){if(this.removeObject(t.objId),e)for(var a=t.notes.iterator;!a.done;)this.removeObject(a.value.objId);if(o)for(var n=t.wayPoints.iterator;!n.done;)this.removeObject(n.value.objId)},addRoute:function(a,n,r,i){i=i||!1;for(var s=[],l=a.itinerary.itineraryPoints.iterator;!l.done;)s.push(l.value.latLng);var d=L.polyline(s,{color:a.color,weight:a.width});if(e(a.objId,d),d.bindTooltip(function(t){return o.getRoute(t.objId).name}),d.bindPopup(function(e){var a=o.getRoute(e.objId);return t("../core/RouteEditor")().getRouteHTML(a,"TravelNotes-")}),L.DomEvent.on(d,"click",function(t){t.target.openPopup(t.latlng)}),i||L.DomEvent.on(d,"contextmenu",function(e){t("../UI/ContextMenu")(e,t("../core/RouteEditor")().getRouteContextMenu(e.target.objId))}),n)for(var u=a.notes.iterator;!u.done;)this.addNote(u.value,i);if(r)for(var c=o.editedRoute.wayPoints.iterator;!c.done;)this.addWayPoint(c.value,c.first?"A":c.last?"B":c.index)},editRoute:function(t){o.mapObjects.get(t.objId).setStyle({color:t.color,weight:t.width})},removeObject:function(t){a(t)},removeAllObjects:function(){o.mapObjects.forEach(function(t,e,a){L.DomEvent.off(t),o.map.removeLayer(t)}),o.mapObjects.clear()},zoomToPoint:function(t){map.setView(t,o.config.itineraryPointZoom)},zoomToRoute:function(t){var e=r(o.getRoute(t));0!==e.length&&o.map.fitBounds(n(e))},zoomToTravel:function(){var t=[];o.travel.routes.forEach(function(e){t=t.concat(r(e))}),travel.notes.forEach(function(e){t.push(e.latLng),t.push(e.iconLatLng)}),0!==t.length&&o.map.fitBounds(n(t))},addItineraryPointMarker:function(t,a){e(t,L.circleMarker(a,o.config.itineraryPointMarker))},addWayPoint:function(a,n){if(0!==a.lat||0!==a.lng){var r='<div class="TravelNotes-WayPoint TravelNotes-WayPoint'+("A"===n?"Start":"B"===n?"End":"Via")+'"></div><div class="TravelNotes-WayPointText">'+n+"</div>",i=L.marker(a.latLng,{icon:L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:r,className:"TravelNotes-WayPointStyle"}),draggable:!0});i.objId=a.objId,e(a.objId,i),L.DomEvent.on(i,"dragend",function(e){o.editedRoute.wayPoints.getAt(e.target.objId).latLng=[e.target.getLatLng().lat,e.target.getLatLng().lng],t("../core/RouteEditor")().wayPointDragEnd(e.target.objId)})}},addNote:function(a,n){n=n||!1;var r=L.marker(a.latLng,{icon:L.divIcon({iconSize:[o.config.note.grip.size,o.config.note.grip.size],iconAnchor:[o.config.note.grip.size/2,o.config.note.grip.size/2],html:"<div></div>"}),zIndexOffset:-1e3,opacity:o.config.note.grip.opacity,draggable:!n});r.objId=a.objId,n||(L.DomEvent.on(r,"dragend",function(e){var a=o.getNoteAndRoute(e.target.objId),n=a.note,r=a.route,i=o.mapObjects.get(e.target.objId);if(null!=r){var s=t("../core/RouteEditor")().getClosestLatLngDistance(r,[e.target.getLatLng().lat,e.target.getLatLng().lng]);n.latLng=s.latLng,n.distance=s.distance,r.notes.sort(function(t,e){return t.distance-e.distance}),i.getLayer(i.bulletId).setLatLng(s.latLng)}else n.latLng=[e.target.getLatLng().lat,e.target.getLatLng().lng];i.getLayer(i.polylineId).setLatLngs([n.latLng,n.iconLatLng]),t("../core/TravelEditor")().changeTravelHTML()}),L.DomEvent.on(r,"drag",function(t){var e=o.getNoteAndRoute(t.target.objId).note,a=o.mapObjects.get(t.target.objId);a.getLayer(a.polylineId).setLatLngs([[t.latlng.lat,t.latlng.lng],e.iconLatLng])}));var i=L.divIcon({iconSize:[a.iconWidth,a.iconHeight],iconAnchor:[a.iconWidth/2,a.iconHeight/2],popupAnchor:[0,-a.iconHeight/2],html:a.iconContent,className:o.config.note.style}),s=L.marker(a.iconLatLng,{icon:i,draggable:!n});s.objId=a.objId,s.bindPopup(function(e){var a=o.getNoteAndRoute(e.objId).note;return t("../core/NoteEditor")().getNoteHTML(a,"TravelNotes-")}),0!==a.tooltipContent.length&&(s.bindTooltip(function(t){return o.getNoteAndRoute(t.objId).note.tooltipContent}),s.getTooltip().options.offset[0]=a.iconWidth/2),n||(L.DomEvent.on(s,"contextmenu",function(e){t("../UI/ContextMenu")(e,t("./NoteEditor")().getNoteContextMenu(e.target.objId))}),L.DomEvent.on(s,"dragend",function(t){var e=o.getNoteAndRoute(t.target.objId).note;e.iconLatLng=[t.target.getLatLng().lat,t.target.getLatLng().lng];var a=o.mapObjects.get(t.target.objId);a.getLayer(a.polylineId).setLatLngs([e.latLng,e.iconLatLng])}),L.DomEvent.on(s,"drag",function(t){var e=o.getNoteAndRoute(t.target.objId).note,a=o.mapObjects.get(t.target.objId);a.getLayer(a.polylineId).setLatLngs([e.latLng,[t.latlng.lat,t.latlng.lng]])}));var l=L.polyline([a.latLng,a.iconLatLng],o.config.note.polyline);l.objId=a.objId;var d=L.layerGroup([s,l,r]);d.markerId=L.Util.stamp(s),d.polylineId=L.Util.stamp(l),d.bulletId=L.Util.stamp(r),e(a.objId,d)},editNote:function(t){var e=L.divIcon({iconSize:[t.iconWidth,t.iconHeight],iconAnchor:[t.iconWidth/2,t.iconHeight/2],popupAnchor:[0,-t.iconHeight/2],html:t.iconContent,className:o.config.note.style}),a=o.mapObjects.get(t.objId),n=a.getLayer(a.markerId);n.setIcon(e),n.unbindTooltip(),0!==t.tooltipContent.length&&(n.bindTooltip(function(t){return o.getNoteAndRoute(t.objId).note.tooltipContent}),n.getTooltip().options.offset[0]=t.iconWidth/2)}}})}()},{"../Data/DataManager":1,"../UI/ContextMenu":10,"../core/NoteEditor":26,"../core/RouteEditor":27,"../core/TravelEditor":29,"./NoteEditor":26}],26:[function(t,e,o){!function(){"use strict";var o=t("../UI/Translator")(),a=t("../Data/DataManager")(),n=t("../util/Utilities")();void 0!==e&&e.exports&&(e.exports=function(){return{newNote:function(e){var o=t("../data/Note")();return o.latLng=e,o.iconLatLng=e,o},newRouteNote:function(e,o){var n=t("../core/RouteEditor")().getClosestLatLngDistance(a.getRoute(e),[o.latlng.lat,o.latlng.lng]),r=this.newNote(n.latLng);r.distance=n.distance,t("../UI/NoteDialog")(r,e,!0)},newManeuverNote:function(e,o){var n=t("../core/RouteEditor")().getClosestLatLngDistance(a.editedRoute,o),r=a.editedRoute.itinerary.maneuvers.getAt(e),i=this.newNote(o);i.distance=n.distance,i.iconContent="<div class='TravelNotes-ManeuverNote TravelNotes-ManeuverNote-"+r.iconName+"'></div>",i.popupContent=r.instruction,i.width=40,i.height=40,t("../UI/NoteDialog")(i,a.editedRoute.objId,!0)},newTravelNote:function(e){var o=this.newNote(e);t("../UI/NoteDialog")(o,-1,!0)},endNoteDialog:function(e,o){if(a.getNoteAndRoute(e.objId).note)t("../core/MapEditor")().editNote(e);else{if(-1===o)a.travel.notes.add(e);else{var n=a.getRoute(o);n.notes.add(e),e.chainedDistance=n.chainedDistance,n.notes.sort(function(t,e){return t.distance-e.distance})}t("../core/MapEditor")().addNote(e)}t("../core/ItineraryEditor")().setItinerary(),t("../core/TravelEditor")().changeTravelHTML()},editNote:function(e){var o=a.getNoteAndRoute(e);t("../UI/NoteDialog")(o.note,null===o.route?-1:o.route.objId,!1)},removeNote:function(e){t("../core/MapEditor")().removeObject(e);var o=a.getNoteAndRoute(e);o.route?(o.route.notes.remove(e),t("../core/ItineraryEditor")().setItinerary()):a.travel.notes.remove(e),t("../core/TravelEditor")().changeTravelHTML()},getMapContextMenu:function(t){var e=[];return e.push({context:this,name:o.getText("NoteEditor - new travel note"),action:this.newTravelNote,param:t}),e},getNoteContextMenu:function(t){var e=[];return e.push({context:this,name:o.getText("NoteEditor - edit note"),action:this.editNote,param:t}),e.push({context:this,name:o.getText("NoteEditor - delete note"),action:this.removeNote,param:t}),e},getNoteHTML:function(t,e){var a="";return 0!==t.tooltipContent.length&&(a+='<div class="'+e+'NoteHtml-TooltipContent">'+t.tooltipContent+"</div>"),0!==t.popupContent.length&&(a+='<div class="'+e+'NoteHtml-PopupContent">'+t.popupContent+"</div>"),0!==t.address.length&&(a+='<div class="'+e+'NoteHtml-Address">'+o.getText("NoteEditor - address")+t.address+"</div>"),0!==t.phone.length&&(a+='<div class="'+e+'NoteHtml-Phone">'+o.getText("NoteEditor - phone")+t.phone+"</div>"),0!==t.url.length&&(a+='<div class="'+e+'NoteHtml-Url">'+o.getText("NoteEditor - url")+'<a href="'+t.url+'" target="_blank">'+t.url+"</a></div>"),a+='<div class="'+e+'NoteHtml-LatLng">'+o.getText("NoteEditor - latlng",{lat:n.formatLat(t.lat),lng:n.formatLng(t.lng)})+"</div>",-1!==t.distance&&(a+='<div class="'+e+'NoteHtml-Distance">'+o.getText("NoteEditor - distance",{distance:n.formatDistance(t.chainedDistance+t.distance)})+"</div>"),a}}})}()},{"../Data/DataManager":1,"../UI/NoteDialog":15,"../UI/Translator":19,"../core/ItineraryEditor":24,"../core/MapEditor":25,"../core/RouteEditor":27,"../core/TravelEditor":29,"../data/Note":35,"../util/Utilities":42}],27:[function(t,e,o){!function(){"use strict";var o=t("../Data/DataManager")(),a=t("../UI/Translator")(),n=t("../core/NoteEditor")(),r=t("../core/MapEditor")(),i=t("../UI/RouteEditorUI")(),s=t("../core/ItineraryEditor")(),l=t("../util/Utilities")();void 0!==e&&e.exports&&(e.exports=function(){return{getClosestLatLngDistance:function(t,e){for(var o=t.itinerary.itineraryPoints.iterator,a=(o.done,Number.MAX_VALUE),n=L.Projection.SphericalMercator.project(L.latLng(e[0],e[1])),r=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),i=null,s=0,l=o.value.distance;!o.done;){var d=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),u=L.LineUtil.pointToSegmentDistance(n,r,d);u<a&&(a=u,s=l-(i=L.Projection.SphericalMercator.unproject(L.LineUtil.closestPointOnSegment(n,r,d))).distanceTo(L.latLng(o.value.lat,o.value.lng))),l+=o.value.distance,r=d}return{latLng:[i.lat,i.lng],distance:s}},saveGpx:function(){var e="time='"+(new Date).toISOString()+"' ",a="<?xml version='1.0'?>\n";a+="<gpx xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xsi:schemaLocation='http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd' version='1.1' creator='Leaflet-Routing-Gpx'>";for(var n=o.editedRoute.wayPoints.iterator;!n.done;)a+="\n\t<wpt lat='"+n.value.lat+"' lon='"+n.value.lng+"' "+e+"/>";a+="\n\t<rte>";for(var r=o.editedRoute.itinerary.maneuvers.iterator;!r.done;){var i=o.editedRoute.itinerary.itineraryPoints.getAt(r.value.itineraryPointObjId),s=r.value.instruction.replace("&","&amp;").replace("'","&apos;").replace('"',"&quote;").replace(">","&gt;").replace("<","&lt;");a+="\n\t\t<rtept lat='"+i.lat+"' lon='"+i.lng+"' "+e+"desc='"+s+"' />"}a+="\n\t</rte>",a+="\n\t<trk>",a+="\n\t\t<trkseg>";for(var l=o.editedRoute.itinerary.itineraryPoints.iterator;!l.done;)a+="\n\t\t\t<trkpt lat='"+l.value.lat+"' lon='"+l.value.lng+"' "+e+" />";a+="\n\t\t</trkseg>",a+="\n\t</trk>",a+="\n</gpx>";var d=o.editedRoute.name;""===d&&(d="TravelNote"),d+=".gpx",t("../util/Utilities")().saveFile(d,a)},getRouteHTML:function(t,e){var o='<div class="'+e+'Route-Header-Name">'+t.name+"</div>";return 0!==t.distance&&(o+='<div class="'+e+'Route-Header-Distance">'+a.getText("RouteEditor - Distance",{distance:l.formatDistance(t.distance)})+'</div><div class="'+e+'Route-Header-Duration">'+a.getText("RouteEditor - Duration",{duration:l.formatTime(t.duration)})+"</div>"),o},chainRoutes:function(){for(var t=o.travel.routes.iterator,e=0;!t.done;){t.value.chain?(t.value.chainedDistance=e,e+=t.value.distance):t.value.chainedDistance=0;for(var a=t.value.notes.iterator;!a.done;)a.value.chainedDistance=t.value.chainedDistance}},startRouting:function(){o.config.routing.auto&&t("../core/Router")().startRouting(o.editedRoute)},endRouting:function(){r.removeRoute(o.editedRoute,!0,!0);for(var e=o.editedRoute.notes.iterator;!e.done;){var a=this.getClosestLatLngDistance(o.editedRoute,e.value.latLng);e.value.latLng=a.latLng,e.value.distance=a.distance}r.addRoute(o.editedRoute,!0,!0),2===o.editedRoute.wayPoints.length&&r.zoomToRoute(o.editedRoute.objId),s.setItinerary(),i.setWayPointsList(),this.chainRoutes(),t("../core/TravelEditor")().changeTravelHTML()},saveEdition:function(){var e=t("../data/Route")();e.object=o.editedRoute.object,o.travel.routes.replace(o.editedRoute.routeInitialObjId,e),o.editedRoute.routeInitialObjId=e.objId,this.clear()},cancelEdition:function(){this.clear()},clear:function(){r.removeRoute(o.editedRoute,!0,!0),r.addRoute(o.getRoute(o.editedRoute.routeInitialObjId),!0,!1),o.editedRoute=t("../data/Route")(),o.editedRoute.routeChanged=!1,o.editedRoute.routeInitialObjId=-1,t("../UI/TravelEditorUI")().setRoutesList(),i.setWayPointsList(),s.setItinerary(),this.chainRoutes(),t("../core/TravelEditor")().changeTravelHTML()},editRoute:function(e){if(o.editedRoute.routeChanged)t("../core/ErrorEditor")().showError(a.getText("RouteEditor - Not possible to edit a route without a save or cancel"));else{-1!==o.editedRoute.routeInitialObjId&&this.clear();var n=o.getRoute(e),l=n.itinerary.provider;if(!l||""===l||o.providers.get(l.toLowerCase())){s.setProvider(l);var d=n.itinerary.transitMode;d&&""!==d&&s.setTransitMode(d),o.editedRoute=t("../data/Route")(),o.editedRoute.object=n.object,o.editedRoute.routeInitialObjId=n.objId,r.removeRoute(n,!0,!1),r.addRoute(o.editedRoute,!0,!0),this.chainRoutes(),i.expand(),i.setWayPointsList(),s.setItinerary()}else t("../core/ErrorEditor")().showError(a.getText("RouteEditor - Not possible to edit a route created with this provider",{provider:l}))}},removeRoute:function(e){t("../core/TravelEditor")().removeRoute(e),this.chainRoutes(),t("../core/TravelEditor")().changeTravelHTML()},routeProperties:function(e){var a=o.getRoute(e);t("../UI/RoutePropertiesDialog")(a)},addWayPoint:function(e,a){o.editedRoute.routeChanged=!0;var n=t("../data/Waypoint.js")();if(e&&(n.latLng=e,o.config.wayPoint.reverseGeocoding&&t("../core/GeoCoder")().getAddress(e[0],e[1],this.renameWayPoint,this,n.objId)),o.editedRoute.wayPoints.add(n),r.addWayPoint(o.editedRoute.wayPoints.last,o.editedRoute.wayPoints.length-2),a){for(var s=o.editedRoute.wayPoints.iterator;!s.done;)if(a<this.getClosestLatLngDistance(o.editedRoute,s.value.latLng).distance){o.editedRoute.wayPoints.moveTo(n.objId,s.value.objId,!0);break}}else o.editedRoute.wayPoints.swap(n.objId,!0);i.setWayPointsList(),this.startRouting()},addWayPointOnRoute:function(t,e){var a=this.getClosestLatLngDistance(o.getRoute(t),[e.latlng.lat,e.latlng.lng]);this.addWayPoint(a.latLng,a.distance)},reverseWayPoints:function(){o.editedRoute.routeChanged=!0;for(var t=o.editedRoute.wayPoints.iterator;!t.done;)r.removeObject(t.value.objId);for(o.editedRoute.wayPoints.reverse(),t=o.editedRoute.wayPoints.iterator;!t.done;)r.addWayPoint(t.value,t.first?"A":t.last?"B":t.index);i.setWayPointsList(),this.startRouting()},removeAllWayPoints:function(){o.editedRoute.routeChanged=!0;for(var t=o.editedRoute.wayPoints.iterator;!t.done;)r.removeObject(t.value.objId);o.editedRoute.wayPoints.removeAll(!0),i.setWayPointsList(),this.startRouting()},removeWayPoint:function(t){o.editedRoute.routeChanged=!0,r.removeObject(t),o.editedRoute.wayPoints.remove(t),i.setWayPointsList(),this.startRouting()},renameWayPoint:function(t,e){o.editedRoute.routeChanged=!0,o.editedRoute.wayPoints.getAt(e).name=t,i.setWayPointsList()},swapWayPoints:function(t,e){o.editedRoute.routeChanged=!0,o.editedRoute.wayPoints.swap(t,e),i.setWayPointsList(),this.startRouting()},setStartPoint:function(e){o.editedRoute.routeChanged=!0,0!==o.editedRoute.wayPoints.first.lat&&r.removeObject(o.editedRoute.wayPoints.first.objId),o.editedRoute.wayPoints.first.latLng=e,o.config.wayPoint.reverseGeocoding&&t("../core/GeoCoder")().getAddress(e[0],e[1],this.renameWayPoint,this,o.editedRoute.wayPoints.first.objId),r.addWayPoint(o.editedRoute.wayPoints.first,"A"),i.setWayPointsList(),this.startRouting()},setEndPoint:function(e){o.editedRoute.routeChanged=!0,0!==o.editedRoute.wayPoints.last.lat&&r.removeObject(o.editedRoute.wayPoints.last.objId),o.editedRoute.wayPoints.last.latLng=e,o.config.wayPoint.reverseGeocoding&&t("../core/GeoCoder")().getAddress(e[0],e[1],this.renameWayPoint,this,o.editedRoute.wayPoints.last.objId),r.addWayPoint(o.editedRoute.wayPoints.last,"B"),i.setWayPointsList(),this.startRouting()},wayPointDragEnd:function(e){if(o.editedRoute.routeChanged=!0,o.config.wayPoint.reverseGeocoding){var a=o.editedRoute.wayPoints.getAt(e).latLng;t("../core/GeoCoder")().getAddress(a[0],a[1],this.renameWayPoint,this,e)}i.setWayPointsList(),this.startRouting()},wayPointDropped:function(t,e,a){if(o.editedRoute.routeChanged=!0,(e!==o.editedRoute.wayPoints.first.objId||!a)&&(e!==o.editedRoute.wayPoints.last.objId||a)){o.editedRoute.wayPoints.moveTo(t,e,a),i.setWayPointsList();for(var n=o.editedRoute.wayPoints.iterator;!n.done;)r.removeObject(n.value.objId),r.addWayPoint(n.value,n.first?"A":n.last?"B":n.index);this.startRouting()}},getMapContextMenu:function(t){var e=[];return e.push({context:this,name:a.getText("RouteEditor - Select this point as start point"),action:-1!==o.editedRoute.routeInitialObjId?this.setStartPoint:null,param:t}),e.push({context:this,name:a.getText("RouteEditor - Select this point as way point"),action:-1!==o.editedRoute.routeInitialObjId?this.addWayPoint:null,param:t}),e.push({context:this,name:a.getText("RouteEditor - Select this point as end point"),action:-1!==o.editedRoute.routeInitialObjId?this.setEndPoint:null,param:t}),e},getRouteContextMenu:function(t){var e=[];return e.push({context:this,name:a.getText("RouteEditor - Edit this route"),action:o.editedRoute.routeInitialObjId===t||o.editedRoute.routeChanged?null:this.editRoute,param:t}),e.push({context:this,name:a.getText("RouteEditor - Delete this route"),action:o.editedRoute.routeInitialObjId===t||o.editedRoute.routeChanged?null:this.removeRoute,param:t}),e.push({context:this,name:a.getText("RouteEditor - Add a waypoint on the route"),action:-1!==o.editedRoute.routeInitialObjId?this.addWayPointOnRoute:null,param:t}),e.push({context:n,name:a.getText("RouteEditor - Add a note on the route"),action:n.newRouteNote,param:t}),e.push({context:this,name:a.getText("RouteEditor - Properties"),action:this.routeProperties,param:t}),e.push({context:r,name:a.getText("RouteEditor - Zoom to route"),action:r.zoomToRoute,param:t}),e.push({context:this,name:a.getText("RouteEditor - Save modifications on this route"),action:o.editedRoute.objId===t?this.saveEdition:null}),e.push({context:this,name:a.getText("RouteEditor - Cancel modifications on this route"),action:o.editedRoute.objId===t?this.cancelEdition:null}),e}}})}()},{"../Data/DataManager":1,"../UI/RouteEditorUI":16,"../UI/RoutePropertiesDialog":17,"../UI/Translator":19,"../UI/TravelEditorUI":20,"../core/ErrorEditor":22,"../core/GeoCoder":23,"../core/ItineraryEditor":24,"../core/MapEditor":25,"../core/NoteEditor":26,"../core/Router":28,"../core/TravelEditor":29,"../data/Route":38,"../data/Waypoint.js":41,"../util/Utilities":42}],28:[function(t,e,o){!function(){"use strict";var o=!1,a=null,n=t("../Data/DataManager")(),r=t("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(){var e=function(){return n.editedRoute.wayPoints.forEach(function(t,e){return null===e&&(e=!0),e&=0!==t.lat&&0!==t.lng})},i=function(e){if(o=!1,a.parseResponse(e,n.editedRoute,n.config.language)){n.editedRoute.itinerary.provider=a.name,n.editedRoute.itinerary.transitMode=n.routing.transitMode;for(var i=n.editedRoute.itinerary.itineraryPoints.iterator,s=0,l=(i.done,i.value);!i.done;)0===l.distance&&(l.distance=L.latLng(l.latLng).distanceTo(L.latLng(i.value.latLng))),s+=l.distance,l=i.value;n.editedRoute.distance=0,n.editedRoute.duration=0;for(var d=n.editedRoute.itinerary.maneuvers.iterator;!d.done;)n.editedRoute.distance+=d.value.distance,n.editedRoute.duration+=d.value.duration;var u=n.editedRoute.distance/s;for(i=n.editedRoute.itinerary.itineraryPoints.iterator;!i.done;)i.value.distance*=u;t("./RouteEditor")().endRouting()}else t("../core/ErrorEditor")().showError(r.getText("Router - An error occurs when parsing the response"))},s=function(e,a){o=!1,t("../core/ErrorEditor")().showError(r.getText("Router - An error occurs when sending the request",{status:e,statusText:a}))},l=function(){o=!0,a=n.providers.get(n.routing.provider);var e="";t("../util/Utilities")().storageAvailable("sessionStorage")&&(e=atob(sessionStorage.getItem(a.name.toLowerCase())));var r=new XMLHttpRequest;r.onreadystatechange=function(t){this.readyState===XMLHttpRequest.DONE&&(200===this.status?i(this.responseText):s(this.status,this.statusText))},r.open("GET",a.getUrl(n.editedRoute.wayPoints,n.routing.transitMode,e,n.config.language,null),!0),r.send(null)},d=function(){return!o&&!!e()&&(l(),!0)};return{startRouting:function(){return d()}}})}()},{"../Data/DataManager":1,"../UI/Translator":19,"../core/ErrorEditor":22,"../util/Utilities":42,"./RouteEditor":27}],29:[function(t,e,o){!function(){"use strict";var o=t("../UI/Translator")(),a=t("../Data/DataManager")(),n=t("../core/MapEditor")(),r=t("../UI/TravelEditorUI")();void 0!==e&&e.exports&&(e.exports=function(){var e=function(){if(t("../util/Utilities")().storageAvailable("localStorage")){var e=t("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Roadbook-",localStorage.setItem(a.UUID+"-TravelNotesHTML",e.travelHTML.outerHTML)}},i=function(o,r,i){try{a.travel.object=JSON.parse(o)}catch(t){return}""!==r&&(a.travel.name=r.substr(0,r.lastIndexOf("."))),a.travel.readOnly=i,n.removeAllObjects();for(var s=a.travel.routes.iterator;!s.done;)n.addRoute(s.value,!0,!1,i);for(var l=a.travel.notes.iterator;!l.done;)n.addNote(l.value,i);n.zoomToTravel(),i?document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-HiddenControl"):(t("../UI/TravelEditorUI")().setRoutesList(),e()),a.map.fire("travelnotesfileloaded",{readOnly:i})};return{changeTravelHTML:function(){e()},addRoute:function(){a.travel.routes.add(t("../Data/Route")()),r.setRoutesList(),t("../core/RouteEditor")().chainRoutes(),this.changeTravelHTML()},editRoute:function(e){t("../core/RouteEditor")().editRoute(e)},removeRoute:function(e){e===a.editedRoute.routeInitialObjId&&a.editedRoute.routeChanged?t("./ErrorEditor")().showError(o.getText("TravelEditor - cannot remove an edited route")):(t("./MapEditor")().removeObject(e),a.travel.routes.remove(e),r.setRoutesList(),e===a.editedRoute.routeInitialObjId&&t("./RouteEditor")().clear(),t("../core/RouteEditor")().chainRoutes(),this.changeTravelHTML())},renameRoute:function(t,e){a.getRoute(t).name=e,r.setRoutesList(),t===a.editedRoute.routeInitialObjId&&(a.editedRoute.name=e),this.changeTravelHTML()},swapRoute:function(e,o){a.travel.routes.swap(e,o),r.setRoutesList(),t("../core/RouteEditor")().chainRoutes(),this.changeTravelHTML()},routeDropped:function(e,o,n){a.travel.routes.moveTo(e,o,n),r.setRoutesList(),t("../core/RouteEditor")().chainRoutes(),this.changeTravelHTML()},saveTravel:function(){a.editedRoute.routeChanged?t("./ErrorEditor")().showError(o.getText("TravelEditor - Not possible to save a travel without a save or cancel")):t("../util/Utilities")().saveFile(a.travel.name+".trv",JSON.stringify(a.travel.object))},openTravel:function(t){var e=new FileReader;e.onload=function(t){i(e.result,o,!1)};var o=t.target.files[0].name;e.readAsText(t.target.files[0])},openServerTravel:function(){var t=decodeURI(window.location.search),e=null;if("fil="===t.substr(1,4)){e=atob(t.substr(5));var o=new XMLHttpRequest;o.onreadystatechange=function(t){this.readyState===XMLHttpRequest.DONE&&200===this.status&&i(this.responseText,"",!0)},o.open("GET",e,!0),o.send(null)}},clear:function(){n.removeAllObjects(),a.editedRoute=t("../Data/Route")(),a.editedRoute.routeChanged=!1,a.editedRoute.routeInitialObjId=-1,a.travel=t("../Data/Travel")(),t("../UI/TravelEditorUI")().setRoutesList(),t("../UI/RouteEditorUI")().setWayPointsList(),t("../core/ItineraryEditor")().setItinerary(),this.changeTravelHTML()},getMapContextMenu:function(e){var a=t("../core/MapEditor")(),n=[];return n.push({context:a,name:o.getText("TravelEditor - Zoom to travel"),action:a.zoomToTravel}),n.push({context:null,name:o.getText("TravelEditor - About"),action:t("../UI/AboutDialog")}),n}}})}()},{"../Data/DataManager":1,"../Data/Route":3,"../Data/Travel":4,"../UI/AboutDialog":7,"../UI/HTMLViewsFactory":13,"../UI/RouteEditorUI":16,"../UI/Translator":19,"../UI/TravelEditorUI":20,"../core/ItineraryEditor":24,"../core/MapEditor":25,"../core/RouteEditor":27,"../util/Utilities":42,"./ErrorEditor":22,"./MapEditor":25,"./RouteEditor":27}],30:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(e){var o=[],a=e,n=function(t){if(!t.objType||!t.objType.name||t.objType.name!==a)throw"invalid object name for add function";o.push(t)},r=function(){return o[0]},i=function(t){for(var e=null,o=c();!o.done;)e=t(o.value,e);return e},s=function(t){var e=u(t);return-1===e?null:o[e]},l=function(){for(var t=[],e=c();!e.done;)t.push(e.value.object);return t},d=function(t,e,a){var n=u(t),r=u(e);a||r++,o.splice(r,0,o[n]),r<n&&n++,o.splice(n,1)},u=function(t){return o.findIndex(function(e){return e.objId===t})},c=function(){var t=-1;return{get value(){return t<o.length?o[t]:null},get done(){return++t>=o.length},get first(){return 0===t},get last(){return t>=o.length-1},get index(){return t}}},v=function(){return o[o.length-1]},g=function(t){if(-1===u(t))throw"invalid objId for remove function";o.splice(u(t),1)},p=function(t){t?o.splice(1,o.length-2):o.length=0},T=function(t,e){var a=u(t);if(-1===a)throw"invalid objId for replace function";o[a]=e},m=function(){o.reverse()},f=function(e){o.length=0;for(var r,i=0;i<e.length;i++){switch(a){case"Route":r=t("../data/Route")();break;case"Note":r=t("../data/Note")();break;case"WayPoint":r=t("../data/WayPoint")();break;case"Maneuver":r=t("../data/Maneuver")();break;case"ItineraryPoint":r=t("../data/ItineraryPoint")();break;default:throw"invalid ObjName ( "+a+" ) in Collection._SetObject"}r.object=e[i],n(r)}},N=function(t){o.sort(t)},I=function(t,e){var a=u(t);if(-1===a||0===a&&e||o.length-1===a&&!e)throw"invalid objId for swap function";var n=o[a];o[a]=o[a+(e?-1:1)],o[a+(e?-1:1)]=n};return{add:function(t){n(t)},forEach:function(t){return i(t)},getAt:function(t){return s(t)},moveTo:function(t,e,o){d(t,e,o)},remove:function(t){g(t)},removeAll:function(t){p(t)},replace:function(t,e){T(t,e)},reverse:function(){m()},sort:function(t){N(t)},swap:function(t,e){I(t,e)},get first(){return r()},get iterator(){return c()},get last(){return v()},get length(){return o.length},get object(){return l()},set object(t){f(t)}}})}()},{"../data/ItineraryPoint":33,"../data/Maneuver":34,"../data/Note":35,"../data/Route":38,"../data/WayPoint":40}],31:[function(t,e,o){arguments[4][1][0].apply(o,arguments)},{"../data/Route":38,"../data/Travel":39,"../util/Utilities":42,dup:1}],32:[function(t,e,o){arguments[4][2][0].apply(o,arguments)},{"../data/Collection":30,"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37,dup:2}],33:[function(t,e,o){!function(){"use strict";var o=t("../data/ObjType")("ItineraryPoint",t("../data/DataManager")().version);void 0!==e&&e.exports&&(e.exports=function(){var e=0,a=0,n=0,r=-1,i=t("../data/ObjId")();return{get lat(){return e},set lat(t){e=t},get lng(){return a},set lng(t){a=t},get latLng(){return[e,a]},set latLng(t){e=t[0],a=t[1]},get distance(){return n},set distance(t){n=t},get maneuverObjId(){return r},set maneuverObjId(t){r=t},get objId(){return i},get objType(){return o},get object(){return{lat:e,lng:a,distance:n,maneuverObjId:r,objId:i,objType:o.object}},set object(s){s=o.validate(s),e=s.lat||0,a=s.lng||0,n=s.distance||0,r=s.maneuverObjId||-1,i=t("../data/ObjId")()}}})}()},{"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37}],34:[function(t,e,o){!function(){"use strict";var o=t("../data/ObjType")("Maneuver",t("../data/DataManager")().version);void 0!==e&&e.exports&&(e.exports=function(){var e=t("../data/ObjId")(),a="",n="",r=-1,i=0,s=0;return{get iconName(){return a},set iconName(t){a=t},get instruction(){return n},set instruction(t){n=t},get itineraryPointObjId(){return r},set itineraryPointObjId(t){r=t},get distance(){return i},set distance(t){i=t},get duration(){return s},set duration(t){s=t},get objId(){return e},get objType(){return o},get object(){return{iconName:a,instruction:n,distance:i,duration:s,itineraryPointObjId:r,objId:e,objType:o.object}},set object(l){l=o.validate(l),a=l.iconName||"",n=l.instruction||"",i=l.distance||0,s=l.duration||0,r=l.itineraryPointObjId||-1,e=t("../data/ObjId")()}}})}()},{"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37}],35:[function(t,e,o){!function(){"use strict";var o=t("../data/ObjType")("Note",t("../data/DataManager")().version);void 0!==e&&e.exports&&(e.exports=function(){var e=t("../data/ObjId")(),a=40,n=40,r="",i="",s="",l="",d="",u="",c=0,v=0,g=0,p=0,T=-1,m=0;return{get isRouteNote(){return-1!==T},get iconHeight(){return a},set iconHeight(t){a=t},get iconWidth(){return n},set iconWidth(t){n=t},get iconContent(){return r},set iconContent(t){r=t},get popupContent(){return i},set popupContent(t){i=t},get tooltipContent(){return s},set tooltipContent(t){s=t},get phone(){return l},set phone(t){l=t},get url(){return d},set url(t){d=t},get address(){return u},set address(t){u=t},get iconLat(){return c},set iconLat(t){c=t},get iconLng(){return v},set iconLng(t){v=t},get iconLatLng(){return[c,v]},set iconLatLng(t){c=t[0],v=t[1]},get lat(){return g},set lat(t){g=t},get lng(){return p},set lng(t){p=t},get latLng(){return[g,p]},set latLng(t){g=t[0],p=t[1]},get distance(){return T},set distance(t){T=t},get chainedDistance(){return m},set chainedDistance(t){m=t},get objId(){return e},get objType(){return o},get object(){return{iconHeight:a,iconWidth:n,iconContent:r,popupContent:i,tooltipContent:s,phone:l,url:d,address:u,iconLat:c,iconLng:v,lat:g,lng:p,distance:T,chainedDistance:m,objId:e,objType:o.object}},set object(f){f=o.validate(f),a=f.iconHeight||40,n=f.iconWidth||40,r=f.iconContent||"",i=f.popupContent||"",s=f.tooltipContent||"",l=f.phone||"",d=f.url||"",u=f.address||"",c=f.iconLat||0,v=f.iconLng||0,g=f.lat||0,p=f.lng||0,T=f.distance||-1,m=f.chainedDistance,e=t("../data/ObjId")()}}})}()},{"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37}],36:[function(t,e,o){(function(t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return++t.travelObjId})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(t,e){var o=t,a=e;return{get name(){return o},get version(){return a},get object(){return{name:o,version:a}},validate:function(t){if(!t.objType)throw"No objType for "+o;if(!t.objType.name)throw"No name for "+o;if(o!==t.objType.name)throw"Invalid name for "+o;if(!t.objType.version)throw"No version for "+o;if(a!==t.objType.version)throw"invalid version for "+o;if(!t.objId)throw"No objId for "+o;return t}}})}()},{}],38:[function(t,e,o){arguments[4][3][0].apply(o,arguments)},{"../data/Collection":30,"../data/DataManager":31,"../data/Itinerary":32,"../data/ObjId":36,"../data/ObjType":37,"../data/Waypoint":41,"./Itinerary":32,dup:3}],39:[function(t,e,o){arguments[4][4][0].apply(o,arguments)},{"../data/Collection":30,"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37,"../data/Route":38,dup:4}],40:[function(t,e,o){!function(){"use strict";var o=t("../data/ObjType")("WayPoint",t("../data/DataManager")().version);void 0!==e&&e.exports&&(e.exports=function(){var e="",a=0,n=0,r=t("../data/ObjId")();return{get name(){return e},set name(t){e=t},get UIName(){return""!==e?e:0!==a&&0!==n?a.toFixed(6)+(0<a?" N - ":" S - ")+n.toFixed(6)+(0<n?" E":" W"):""},get lat(){return a},set lat(t){a=t},get lng(){return n},set lng(t){n=t},get latLng(){return[a,n]},set latLng(t){a=t[0],n=t[1]},get objId(){return r},get objType(){return o},get object(){return{name:e,lat:a,lng:n,objId:r,objType:o.object}},set object(i){i=o.validate(i),e=i.name||"",a=i.lat||0,n=i.lng||0,r=t("../data/ObjId")()}}})}()},{"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37}],41:[function(t,e,o){arguments[4][40][0].apply(o,arguments)},{"../data/DataManager":31,"../data/ObjId":36,"../data/ObjType":37,dup:40}],42:[function(t,e,o){!function(){"use strict";var o=t("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(){var t=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()};return{get UUID(){return t()},storageAvailable:function(t){try{var e=window[t],o="__storage_test__";return e.setItem(o,o),e.removeItem(o),!0}catch(t){return!1}},fileAPIAvailable:function(){try{return new File(["testdata"],{type:"text/plain"}),!0}catch(t){return!!window.navigator.msSaveOrOpenBlob}},saveFile:function(t,e,o){if(o||(o="text/plain"),window.navigator.msSaveOrOpenBlob)try{window.navigator.msSaveOrOpenBlob(new Blob([e]),t)}catch(t){}else try{var a=window.URL.createObjectURL(new File([e],{type:o})),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}catch(t){}},formatTime:function(t){if(0===(t=Math.floor(t)))return"";var e=Math.floor(t/86400),a=Math.floor(t%86400/3600),n=Math.floor(t%3600/60),r=Math.floor(t%60);return 0<e?e+"&nbsp;"+o.getText("Utilities - day")+"&nbsp;"+a+"&nbsp;h":0<a?a+"&nbsp;"+o.getText("Utilities - hour")+"&nbsp;"+n+"&nbsp;"+o.getText("Utilities - minute"):0<n?n+"&nbsp;"+o.getText("Utilities - minute"):r+"&nbsp;"+o.getText("Utilities - second")},formatDistance:function(t){return 0===(t=Math.floor(t))?"":1e3>t?t.toFixed(0)+"&nbsp;m":Math.floor(t/1e3)+"."+Math.floor(t%1e3/100)+"&nbsp;km"},formatLat:function(t){return t>0?t.toFixed(6)+"&nbsp;N":(-t).toFixed(6)+"&nbsp;S"},formatLng:function(t){return t>0?t.toFixed(6)+"&nbsp;E":(-t).toFixed(6)+"&nbsp;W"},formatLatLng:function(t){return this.formatLat(t[0])+"&nbsp;-&nbsp;"+this.formatLng(t[1])}}})}()},{"../UI/Translator":19}]},{},[6]);