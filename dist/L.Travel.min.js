/*! leaflet.Travel - version 0.1.0 - 2017-08-28 - Copyright 2015 2017 Christian Guyette - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/


!function t(e,o,n){function r(i,s){if(!o[i]){if(!e[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);var d=new Error("Cannot find module '"+i+"'");throw d.code="MODULE_NOT_FOUND",d}var c=o[i]={exports:{}};e[i][0].call(c.exports,function(t){var o=e[i][1][t];return r(o||t)},c,c.exports,t,e,o,n)}return o[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,o){!function(){"use strict";var o="Geom",n="1.0.0";void 0!==e&&e.exports&&(e.exports=function(){var e="",r=6,a="#000000",i=5,s=t("./ObjId")();return{get pnts(){return e},set pnts(t){e=t},get precision(){return r},set precision(t){r=t},get color(){return a},set color(t){a=t},get weight(){return i},set weight(t){i=t},get objId(){return s},get objName(){return o},get objVersion(){return n},get object(){return{pnts:e,precision:r,color:a,weight:i,objId:s,objName:o,objVersion:n}},set object(o){if(!o.objVersion)throw"No ObjVersion for Geom";if("1.0.0"!==o.objVersion)throw"invalid objVersion for Geom";if(!o.objName)throw"No objName for Geom";if("Geom"!==o.objName)throw"Invalid objName for Geom";e=o.pnts||"",r=o.precision||6,a=o.color||"#000000",i=o.weight||5,s=t("./ObjId")()}}})}()},{"./ObjId":5}],2:[function(t,e,o){!function(){"use strict";var t=function(){return{create:function(t,e,o){var n;if(n="text"===t.toLowerCase()?document.createTextNode(""):document.createElement(t),o&&o.appendChild(n),e)for(var r in e)try{n[r]=e[r]}catch(t){console.log("Invalid property : "+r)}return n}}};void 0!==e&&e.exports&&(e.exports=function(){return t()})}()},{}],3:[function(t,e,o){!function(){"use strict";L.Travel=L.Travel||{},L.travel=L.travel||{},L.Travel.Control=L.Control.extend({options:{position:"topright"},initialize:function(t){L.Util.setOptions(this,t)},onAdd:function(e){return t("./userInterface")().UI}}),L.travel.control=function(t){return new L.Travel.Control(t)},void 0!==e&&e.exports&&(e.exports=L.travel.control)}()},{"./userInterface":14}],4:[function(t,e,o){!function(){"use strict";L.Travel=L.Travel||{},L.travel=L.travel||{},L.Travel.getInterface=function(){return t("./TravelData")().object={name:"TravelData sample",routes:[{name:"Chemin du Sârtê",wayPoints:[{name:"Chemin du Sârtê 1 - Anthisnes",lat:50.50881,lng:5.49314,objId:-1,objName:"WayPoint",objVersion:"1.0.0"},{name:"Chemin du Sârtê 22 - Anthisnes",lat:50.50937,lng:5.4947,objId:-2,objName:"WayPoint",objVersion:"1.0.0"}],geom:{pnts:"w~xi_BwwgnIaHkLgIkUmEyTcLie@",precision:6,color:"#0000ff",weight:"5",objId:-3,objName:"Geom",objVersion:"1.0.0"},objId:-4,objName:"Route",objVersion:"1.0.0"}],objId:-5,objName:"TravelData",objVersion:"1.0.0"},{addControl:function(o,n){void 0!==e&&e.exports?o.addControl(t("./L.Travel.Control")(n)):o.addControl(L.marker.pin.control(n))},addWayPoint:function(t,e){console.log("addWayPoint")}}},L.travel.interface=function(){return L.Travel.getInterface()},void 0!==e&&e.exports&&(e.exports=L.travel.interface)}()},{"./L.Travel.Control":3,"./TravelData":11}],5:[function(t,e,o){!function(){"use strict";var t=0;void 0!==e&&e.exports&&(e.exports=function(){return++t})}()},{}],6:[function(t,e,o){!function(){"use strict";var o="Route",n="1.0.0";void 0!==e&&e.exports&&(e.exports=function(){var e="",r=[t("./Waypoint")(),t("./waypoint")()],a=t("./Geom")(),i=t("./ObjId")();return{get name(){return e},set name(t){e=t},addWayPoint:function(t){if(r.push(t),2<r.length){var e=r[r.length-2];return r[r.length-2]=r[r.length-1],void(r[r.length-1]=e)}},removeWayPoint:function(t){r.splice(this.indexOfWayPoint(t),1)},removeAllWayPoints:function(){r=[r[0],r[r.length-1]]},swapWayPoints:function(t,e){var o=this.indexOfWayPoint(t),n=r[this.indexOfWayPoint(t)];r[o]=r[o+(e?-1:1)],r[o+(e?-1:1)]=n},get wayPoints(){return r},indexOfWayPoint:function(t){return r.findIndex(function(e){return e.objId===t})},get geom(){return a},set geom(t){a=t},get objId(){return i},get objName(){return o},get objVersion(){return n},get object(){for(var t=[],s=0;s<r.length;s++)t.push(r[s].object);return{name:e,wayPoints:t,geom:a.object,objId:i,objName:o,objVersion:n}},set object(o){if(!o.objVersion)throw"No ObjVersion for Route";if("1.0.0"!==o.objVersion)throw"invalid objVersion for Route";if(!o.objName)throw"No objName for Route";if("Route"!==o.objName)throw"Invalid objName for Route";e=o.name||"",r.length=0;for(var n=0;n<o.wayPoints.length;n++){var s=t("./WayPoint")();s.object=o.wayPoints[n],r.push(s)}var l=t("./Geom")();l.object=o.geom,a=l,i=t("./ObjId")()}}})}()},{"./Geom":1,"./ObjId":5,"./WayPoint":12,"./Waypoint":13,"./waypoint":15}],7:[function(t,e,o){!function(){"use strict";var o=t("./Route")(),n=-1,r=!1;void 0!==e&&e.exports&&(e.exports=function(){return{editRoute:function(e){r=!1,n=e.objId,o.object=e.object,t("./RouteEditorUI")().setRouteData(o)},addWayPoint:function(){r=!0;var e=t("./Waypoint.js")();return o.addWayPoint(e),o.wayPoints},reverseWayPoints:function(){return r=!0,o.wayPoints.reverse(),o.wayPoints},removeAllWayPoints:function(){return r=!0,o.removeAllWayPoints(),o.wayPoints},removeWayPoint:function(t){return r=!0,o.removeWayPoint(t),o.wayPoints},renameWayPoint:function(t,e){r=!0,o.wayPoints[o.indexOfWayPoint(t)].name=e},swapWayPoints:function(t,e){return r=!0,o.swapWayPoints(t,e),o.wayPoints}}})}()},{"./Route":6,"./RouteEditorUI":8,"./Waypoint.js":13}],8:[function(t,e,o){!function(){"use strict";t("./TravelData")();var o=null,n=null,r=t("./RouteEditor")(),a=function(t){o.removeAllItems();for(var e=0;e<t.length;e++)o.addItem(t[e].UIName,t[e].objId,e===t.length-1)},i=function(t){t.target.parentNode.parentNode.childNodes[1].classList.toggle("TravelControl-HiddenList"),t.target.parentNode.parentNode.childNodes[2].classList.toggle("TravelControl-HiddenList"),t.target.innerHTML=t.target.parentNode.parentNode.childNodes[1].classList.contains("TravelControl-HiddenList")?"&#x25b6;":"&#x25bc;",t.target.title=t.target.parentNode.parentNode.childNodes[1].classList.contains("TravelControl-HiddenList")?"Afficher":"Masquer",t.stopPropagation()},s=function(t){var e=r.addWayPoint();a(e),t.stopPropagation()},l=function(t){var e=r.reverseWayPoints();a(e),t.stopPropagation()},d=function(t){var e=r.removeAllWayPoints();a(e),t.stopPropagation()},c=function(t){var e=r.removeWayPoint(t.itemNode.dataObjId);a(e),t.stopPropagation()},u=function(t){var e=r.swapWayPoints(t.itemNode.dataObjId,!0);a(e),t.stopPropagation()},v=function(t){var e=r.swapWayPoints(t.itemNode.dataObjId,!1);a(e),t.stopPropagation()},p=function(t){r.renameWayPoint(t.dataObjId,t.changeValue),t.stopPropagation()};void 0!==e&&e.exports&&(e.exports=function(){return n||function(){var e=t("./HTMLElementsFactory")();n=e.create("div",{id:"TravelControl-WayPointsDiv",className:"TravelControl-Div"});var r=e.create("div",{id:"TravelControl-WaypointsHeaderDiv",className:"TravelControl-HeaderDiv"},n);e.create("span",{innerHTML:"&#x25bc",id:"TravelControl-WayPointsExpandButton",className:"TravelControl-ExpandButton"},r).addEventListener("click",i,!1),e.create("span",{innerHTML:"Points de passage&nbsp;:",id:"TravelControl-WayPointsHeaderText",className:"TravelControl-HeaderText"},r),(o=t("./SortableList")({minSize:0,listStyle:"LimitedSort",placeholders:["Start","Via","End"],indexNames:["A","index","B"],id:"TravelControl-WaypointsList"},n)).container.addEventListener("SortableListDelete",c,!1),o.container.addEventListener("SortableListUpArrow",u,!1),o.container.addEventListener("SortableListDownArrow",v,!1),o.container.addEventListener("SortableListChange",p,!1);var a=e.create("div",{id:"TravelControl-WayPointsButtonsDiv",className:"TravelControl-ButtonsDiv"},n);e.create("span",{id:"TravelControl-AddWayPointButton",className:"TravelControl-Button",title:"Ajouter un point de passage",innerHTML:"+"},a).addEventListener("click",s,!1),e.create("span",{id:"TravelControl-ReverseWayPointsButton",className:"TravelControl-Button",title:"Inverser les points de passage",innerHTML:"&#x21C5;"},a).addEventListener("click",l,!1),e.create("span",{id:"TravelControl-RemoveAllWayPointsButton",className:"TravelControl-Button",title:"Supprimer tous les points de passage",innerHTML:"&#x1f5d1;"},a).addEventListener("click",d,!1)}(),{get UI(){return n},setRouteData:function(t){a(t.wayPoints)}}})}()},{"./HTMLElementsFactory":2,"./RouteEditor":7,"./SortableList":10,"./TravelData":11}],9:[function(t,e,o){!function(){"use strict";var o=t("./TravelData")(),n=null,r=null,a=function(t){n.removeAllItems(),o.removeAllRoutes(),t.stopPropagation()},i=function(t){var e=o.addRoute();n.addItem(e.name,e.objId),t.stopPropagation()},s=function(t){t.target.parentNode.parentNode.childNodes[1].classList.toggle("TravelControl-HiddenList"),t.target.parentNode.parentNode.childNodes[2].classList.toggle("TravelControl-HiddenList"),t.target.innerHTML=t.target.parentNode.parentNode.childNodes[1].classList.contains("TravelControl-HiddenList")?"&#x25b6;":"&#x25bc;",t.target.title=t.target.parentNode.parentNode.childNodes[1].classList.contains("TravelControl-HiddenList")?"Afficher":"Masquer",t.stopPropagation()},l=function(t){o.removeRoute(t.itemNode.dataObjId),t.itemNode.parentNode.removeChild(t.itemNode),t.stopPropagation()},d=function(t){var e=o.indexOfRoute(t.itemNode.dataObjId),n=o.routes[e];o.routes[e]=o.routes[e-1],o.routes[e-1]=n,t.itemNode.parentNode.insertBefore(t.itemNode,t.itemNode.previousSibling),t.stopPropagation()},c=function(t){var e=o.indexOfRoute(t.itemNode.dataObjId),n=o.routes[e];o.routes[e]=o.routes[e+1],o.routes[e+1]=n,t.itemNode.parentNode.insertBefore(t.itemNode.nextSibling,t.itemNode),t.stopPropagation()},u=function(e){e.stopPropagation(),t("./RouteEditor")().editRoute(o.routes[o.indexOfRoute(e.itemNode.dataObjId)]),e.stopPropagation()},v=function(t){o.routes[o.indexOfRoute(t.dataObjId)].name=t.changeValue,t.stopPropagation()};void 0!==e&&e.exports&&(e.exports=function(){return r||(function(){var e=t("./HTMLElementsFactory")();r=e.create("div",{id:"TravelControl-RoutesDiv",className:"TravelControl-Div"});var o=e.create("div",{id:"TravelControl-RoutesHeaderDiv",className:"TravelControl-HeaderDiv"},r);e.create("span",{innerHTML:"&#x25bc;",id:"TravelControl-RoutesExpandButton",className:"TravelControl-ExpandButton"},o).addEventListener("click",s,!1),e.create("span",{innerHTML:"Routes&nbsp;:",id:"TravelControl-RoutesHeaderText",className:"TravelControl-HeaderText"},o),(n=t("./SortableList")({minSize:0,placeholders:["Route"],id:"TravelControl-RouteList"},r)).container.addEventListener("SortableListDelete",l,!1),n.container.addEventListener("SortableListUpArrow",d,!1),n.container.addEventListener("SortableListDownArrow",c,!1),n.container.addEventListener("SortableListRightArrow",u,!1),n.container.addEventListener("SortableListChange",v,!1);var p=e.create("div",{id:"TravelControl-RoutesButtonsDiv",className:"TravelControl-ButtonsDiv"},r);e.create("span",{id:"TravelControl-AddRoutesButton",className:"TravelControl-Button",title:"Nouvelle route",innerHTML:"+"},p).addEventListener("click",i,!1),e.create("span",{id:"TravelControl-DeleteAllRoutesButton",className:"TravelControl-Button",title:"Supprimer toutes les routes",innerHTML:"&#x1f5d1;"},p).addEventListener("click",a,!1)}(),function(){for(var t=o.routes,e=0;e<t.length;e++)t[e].uiObjId=n.addItem(t[e].name,t[e].objId)}()),{get UI(){return r}}})}()},{"./HTMLElementsFactory":2,"./RouteEditor":7,"./SortableList":10,"./TravelData":11}],10:[function(t,e,o){!function(){"use strict";var o=function(t){t.stopPropagation();try{t.dataTransfer.setData("Text","1")}catch(t){}console.log("onDragStart")},n=function(t){t.preventDefault(),console.log("onDragOver")},r=function(t){t.preventDefault();t.dataTransfer.getData("Text");console.log("onDrop")},a=function(t){var e=new Event("SortableListDelete");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},i=function(t){var e=new Event("SortableListUpArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},s=function(t){var e=new Event("SortableListDownArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},l=function(t){var e=new Event("SortableListRightArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},d=function(t){console.log("onChange");var e=new Event("SortableListChange");e.dataObjId=t.target.parentNode.dataObjId,e.changeValue=t.target.value,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},c=function(e,c){var u=t("./HTMLElementsFactory")();this.items=[],this.removeAllItems=function(){for(var t=0;t<this.items.length;t++)this.container.removeChild(this.items[t]);this.items.length=0},this.addItem=function(e,n,r){e=e||"",n=n||-1;var c="";if(1===this.options.placeholders.length&&(c=this.options.placeholders[0]),3===this.options.placeholders.length){switch(this.items.length){case 0:c=this.options.placeholders[0];break;default:c=this.options.placeholders[1]}r&&(c=this.options.placeholders[2])}var v="";if(1===this.options.indexNames.length&&(v=this.options.indexNames[0]),3===this.options.indexNames.length){switch(this.items.length){case 0:v=this.options.indexNames[0];break;default:v=this.options.indexNames[1]}r&&(v=this.options.indexNames[2])}"index"===v&&(v=this.items.length);var p=u.create("div",{draggable:!1,className:"SortableList-Item"});u.create("span",{className:"SortableList-ItemTextIndex",innerHTML:v},p),u.create("input",{type:"text",className:"SortableList-ItemInput",placeholder:c,value:e},p).addEventListener("change",d,!1),u.create("span",{className:"SortableList-ItemDeleteButton",title:"Supprimer",innerHTML:"&#x1f5d1;"},p).addEventListener("click",a,!1),u.create("span",{className:"SortableList-ItemUpArrowButton",title:"Déplacer vers le haut",innerHTML:String.fromCharCode(8679)},p).addEventListener("click",i,!1),u.create("span",{className:"SortableList-ItemDownArrowButton",title:"Déplacer vers le bas",innerHTML:String.fromCharCode(8681)},p).addEventListener("click",s,!1),"AllSort"===this.options.listStyle&&u.create("span",{className:"SortableList-ItemRightArrowButton",title:"Éditer",innerHTML:String.fromCharCode(8688)},p).addEventListener("click",l,!1),p.dataObjId=n,p.UIObjId=t("./ObjId")(),this.items.push(p),("LimitedSort"!==this.options.listStyle||1<this.items.length)&&!r&&(p.draggable=!0,p.addEventListener("dragstart",o,!1),p.classList.add("SortableList-MoveCursor")),this.container.appendChild(p)},this._create=function(t,e){this.options={minSize:2,listStyle:"AllSort",placeholders:[],indexNames:[],id:"SortableList-Container"};for(var o in t)this.options[o]=t[o];"LimitedSort"===this.options.listStyle&&2>this.options.minSize&&(this.options.minSize=2),this.container=u.create("div",{id:t.id,className:"SortableList-Container"}),this.container.classList.add(this.options.listStyle),this.container.addEventListener("dragover",n,!1),this.container.addEventListener("drop",r,!1),e&&e.appendChild(this.container);for(var a=0;a<this.options.minSize;a++)this.addItem()},this._create(e,c)};void 0!==e&&e.exports&&(e.exports=function(t,e){return new c(t,e)})}()},{"./HTMLElementsFactory":2,"./ObjId":5}],11:[function(t,e,o){!function(){"use strict";var o="TravelData",n="1.0.0",r="",a=[],i=-1,s=[];void 0!==e&&e.exports&&(e.exports=function(){return{clear:function(){for(var t=0;t<a.length;t++)s.push({timeStamp:(new Date).toISOString(),route:a[t].object});this.object={name:"",routes:[{name:"",wayPoints:[{name:"",lat:0,lng:0,objId:-1,objName:"WayPoint",objVersion:"1.0.0"},{name:"",lat:0,lng:0,objId:-1,objName:"WayPoint",objVersion:"1.0.0"}],geom:{pnts:"",precision:6,color:"#000000",weight:"5",objId:-1,objName:"Geom",objVersion:"1.0.0"},objId:-1,objName:"Route",objVersion:"1.0.0"}],objId:-1,objName:"TravelData",objVersion:"1.0.0"}},removeAllRoutes:function(){for(var t=0;t<a.length;t++)s.push({timeStamp:(new Date).toISOString(),route:a[t].object});a.length=0},removeRoute:function(t){s.push({timeStamp:(new Date).toISOString(),route:a.splice(this.indexOfRoute(t),1)[0].object})},addRoute:function(){var e=t("./Route")();return a.push(e),e},indexOfRoute:function(t){return a.findIndex(function(e){return e.objId===t})},get routes(){return a},get objId(){return i},get objName(){return o},get objVersion(){return n},get object(){for(var t=[],e=0;e<a.length;e++)t.push(a[e].object);return{name:r,routes:t,objId:i,objName:o,objVersion:n}},set object(e){if(!e.objVersion)throw"No ObjVersion for TravelData";if("1.0.0"!==e.objVersion)throw"invalid objVersion for TravelData";if(!e.objName)throw"No objName for TravelData";if("TravelData"!==e.objName)throw"Invalid objName for TravelData";r=e.name||"",a.length=0;for(var o=0;o<e.routes.length;o++){var n=t("./Route")();n.object=e.routes[o],a.push(n)}i=t("./ObjId")()}}})}()},{"./ObjId":5,"./Route":6}],12:[function(t,e,o){!function(){"use strict";var o="WayPoint",n="1.0.0";void 0!==e&&e.exports&&(e.exports=function(){var e="",r=0,a=0,i=t("./ObjId")();return{get name(){return e},set name(t){e=t},get UIName(){return""!==e?e:0!==r&&0!==a?r.toString()+(0<r?" N - ":" S - ")+Lng.toString()+(0<r?" E - ":" W - "):""},get lat(){return r},set lat(t){r=t},get lng(){return a},set lng(t){a=t},get latLng(){return[r,a]},set latLng(t){r=t[0],a=t[1]},get objId(){return i},get objName(){return o},get objVersion(){return n},get object(){return{name:e,lat:r,lng:a,objId:i,objName:o,objVersion:n}},set object(o){if(!o.objVersion)throw"No ObjVersion for WayPoint";if("1.0.0"!==o.objVersion)throw"invalid objVersion for WayPoint";if(!o.objName)throw"No objName for WayPoint";if("WayPoint"!==o.objName)throw"Invalid objName for WayPoint";e=o.name||"",r=o.lat||0,a=o.lng||0,i=t("./ObjId")()}}})}()},{"./ObjId":5}],13:[function(t,e,o){arguments[4][12][0].apply(o,arguments)},{"./ObjId":5,dup:12}],14:[function(t,e,o){!function(){"use strict";var o=null;void 0!==e&&e.exports&&(e.exports=function(){return o||function(){var e=t("./HTMLElementsFactory")();(o=e.create("div",{id:"TravelControl-MainDiv"})).appendChild(t("./RoutesUI")().UI),o.appendChild(t("./RouteEditorUI")().UI);var n=e.create("div",{id:"TravelControl-ItineraryDiv",className:"TravelControl-Div"},o);e.create("span",{innerHTML:"Itinéraire&nbsp;:",id:"TravelControl-ItineraryHeaderText",className:"TravelControl-HeaderText"},n),e.create("div",{id:"TravelControl-ItineraryDiv",className:"TravelControl-Div"},o)}(),{get UI(){return o}}})}()},{"./HTMLElementsFactory":2,"./RouteEditorUI":8,"./RoutesUI":9}],15:[function(t,e,o){arguments[4][12][0].apply(o,arguments)},{"./ObjId":5,dup:12}]},{},[4]);